2025-08-29 05:02:36,437 INFO    ThreadPoolExecutor-0_0:128691 [wandb_setup.py:_flush():81] Current SDK version is 0.21.2
2025-08-29 05:02:36,438 INFO    ThreadPoolExecutor-0_0:128691 [wandb_setup.py:_flush():81] Configure stats pid to 128691
2025-08-29 05:02:36,438 INFO    ThreadPoolExecutor-0_0:128691 [wandb_setup.py:_flush():81] Loading settings from /home/terry/.config/wandb/settings
2025-08-29 05:02:36,438 INFO    ThreadPoolExecutor-0_0:128691 [wandb_setup.py:_flush():81] Loading settings from /home/terry/gcs-bucket/Distillation/vision/train/wandb/settings
2025-08-29 05:02:36,438 INFO    ThreadPoolExecutor-0_0:128691 [wandb_setup.py:_flush():81] Loading settings from environment variables
2025-08-29 05:02:36,487 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:setup_run_log_directory():686] Logging user logs to /home/terry/gcs-bucket/Distillation/vision/train/wandb/run-20250829_050233-wcbe2m0y/logs/debug.log
2025-08-29 05:02:36,533 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:setup_run_log_directory():687] Logging internal logs to /home/terry/gcs-bucket/Distillation/vision/train/wandb/run-20250829_050233-wcbe2m0y/logs/debug-internal.log
2025-08-29 05:02:36,533 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():813] calling init triggers
2025-08-29 05:02:36,533 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():818] wandb.init called with sweep_config: {}
config: {'batch_size': 128, 'epochs': 100, 'update_freq': 1, 'model': 'my_vit_b', 'drop_path': 0.1, 'input_size': 224, 'layer_scale_init_value': 1e-06, 'model_ema': False, 'model_ema_decay': 0.9999, 'model_ema_force_cpu': True, 'model_ema_eval': False, 'opt': 'adamw', 'opt_eps': 1e-08, 'opt_betas': None, 'clip_grad': None, 'momentum': 0.9, 'weight_decay': 0.05, 'weight_decay_end': None, 'lr': 0.004, 'layer_decay': 1.0, 'min_lr': 1e-06, 'warmup_epochs': 20, 'warmup_steps': -1, 'color_jitter': 0.4, 'aa': 'rand-m9-mstd0.5-inc1', 'smoothing': 0.1, 'train_interpolation': 'bicubic', 'crop_pct': 0.875, 'reprob': 0.25, 'remode': 'pixel', 'recount': 1, 'resplit': False, 'mixup': 0.8, 'cutmix': 1.0, 'cutmix_minmax': None, 'mixup_prob': 1.0, 'mixup_switch_prob': 0.5, 'mixup_mode': 'batch', 'finetune': '', 'head_init_scale': 1.0, 'model_key': 'model|module', 'model_prefix': '', 'data_path': '/mnt/ramdisk/imagenet-hdf5', 'eval_data_path': None, 'nb_classes': 1000, 'imagenet_default_mean_and_std': True, 'data_set': 'IMNET_HDF5', 'cache_dataset_in_ram': False, 'output_dir': '/home/terry/models/vanilla/b-vanilla', 'log_dir': None, 'device': 'cuda', 'seed': 0, 'resume': '', 'auto_resume': False, 'save_ckpt': True, 'save_ckpt_freq': 1, 'save_ckpt_num': 3, 'start_epoch': 0, 'eval': False, 'dist_eval': True, 'disable_eval': False, 'num_workers': 12, 'pin_mem': False, 'world_size': 32, 'local_rank': -1, 'dist_on_itp': False, 'dist_url': 'env://', 'use_amp': False, 'enable_wandb': True, 'wandb_mode': 'online', 'wandb_dir': None, 'project': 'tpu-vit', 'wandb_ckpt': False, 'experiment': 'b-vanilla', 'log_freq': 50, 'kd': False, 'teacher_path': '', 'teacher_arch': '', 'kd_alpha': 0.7, 'kd_temperature': 4.0, 'tpu': True, 'rank': 0, 'gpu': 0, 'dist_backend': 'xla', 'distributed': True, '_dataset_train': <datasets.HDF5ImageDataset object at 0x764480b4f430>, '_dataset_val': <datasets.HDF5ImageDataset object at 0x764480b4faf0>, '_xla_device': device(type='xla'), '_tpu_spawned_process': True, '_wandb': {}}
2025-08-29 05:02:36,533 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():854] starting backend
2025-08-29 05:02:36,820 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():857] sending inform_init request
2025-08-29 05:02:37,567 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():865] backend started and connected
2025-08-29 05:02:37,609 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():936] updated telemetry
2025-08-29 05:02:40,485 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():960] communicating run to backend with 90.0 second timeout
2025-08-29 05:02:40,753 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():1011] starting run threads in backend
2025-08-29 05:02:42,162 INFO    ThreadPoolExecutor-0_0:128691 [wandb_run.py:_console_start():2494] atexit reg
2025-08-29 05:02:42,162 INFO    ThreadPoolExecutor-0_0:128691 [wandb_run.py:_redirect():2342] redirect: wrap_raw
2025-08-29 05:02:42,163 INFO    ThreadPoolExecutor-0_0:128691 [wandb_run.py:_redirect():2411] Wrapping output streams.
2025-08-29 05:02:42,163 INFO    ThreadPoolExecutor-0_0:128691 [wandb_run.py:_redirect():2434] Redirects installed.
2025-08-29 05:02:42,351 INFO    ThreadPoolExecutor-0_0:128691 [wandb_init.py:init():1057] run started, returning control to user process
2025-08-29 05:02:43,295 INFO    wandb-AsyncioManager-main:128691 [service_client.py:_forward_responses():84] Reached EOF.
2025-08-29 05:02:43,295 INFO    wandb-AsyncioManager-main:128691 [mailbox.py:close():137] Closing mailbox, abandoning 1 handles.
