W&B online run started. URL: https://wandb.ai/ttl/tpu-vit/runs/brvrd0r4
TPU mode: Using num_workers=0 to avoid pickle issues, will use MpDeviceLoader for parallelism
Mixup is activated!
WARNING:timm.models._builder:No pretrained configuration specified for my_vit_b model. Using a default. Please add a config to the model pretrained_cfg registry or pass explicitly.
Forcing XLA synchronization after model.to(device)...
XLA mark_step() after model.to(device) completed
Forcing XLA synchronization before parameter counting...
XLA mark_step() completed
TPU spawned process: world_size = 64
Calculated total_batch_size = 16384
Number of training examples = 1281167
LR = 0.00400000
Batch size = 16384
Update frequent = 1
Number of training steps per epoch = 78
TPU multihost mode: XLA handles data distribution internally
About to create optimizer...
TPU mode: Using name-only parameter grouping to avoid XLA compilation
TPU mode: Collecting parameter names...
TPU mode: Found 152 trainable parameters
TPU mode: Grouping parameters by names...
Processing parameter 1/152: cls_token
Processing parameter 51/152: blocks.3.mlp.fc2.weight
Processing parameter 101/152: blocks.8.norm1.weight
Processing parameter 151/152: head.weight
TPU mode: Parameter names grouped successfully
TPU mode: Mapping names to tensors...
TPU mode: All 152 parameters mapped successfully
Parameter iteration completed! Processed 152 parameters.
TPU mode: Created 2 parameter groups, returning optimizer groups...
Parameter groups created successfully
Optimizer created successfully
TPU mode: Skipping loss scaler (XLA handles mixed precision)
TPU mode: About to set loss_scaler = None...
TPU mode: Loss scaler set to None
About to create Cosine LR scheduler...
Set warmup steps = 1560
LR scheduler created successfully
About to continue to weight decay scheduler...
About to check args.weight_decay_end...
Directly setting weight_decay_end to avoid freeze...
weight_decay_end set to: 0.05
About to call cosine_scheduler for weight decay...
Calling with: wd=0.05, wd_end=0.05, epochs=100, steps_per_epoch=78
Set warmup steps = 0
cosine_scheduler completed, about to calculate min/max...
Weight decay schedule created: 0.05 -> 0.05
About to create criterion...
Created SoftTargetCrossEntropy criterion
criterion = SoftTargetCrossEntropy()
TPU mode: Skipping warmup (caused shape errors), will compile on first iteration
About to call auto_load_model...
auto_load_model completed
About to define get_eval_model helper function...
get_eval_model function defined
About to set max_accuracy...
max_accuracy initialized
🚀 Creating MpDeviceLoader for training DataLoader (TPU optimization)...
✅ Training MpDeviceLoader created successfully
🚀 Creating MpDeviceLoader for validation DataLoader (TPU optimization)...
✅ Validation MpDeviceLoader created successfully
Start training for 100 epochs
About to record start_time...
About to enter training loop...
Starting epoch 0 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(0)...
✅ original_train_sampler.set_epoch(0) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 0
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
📊 First enumerate() call took 201.32s
🚀 Starting data_iter_step 0 (DataLoader iteration took 0.000s)...
Epoch: [0]  [ 0/78]  eta: 5:26:22  loss: 7.1250 (7.1250)  lr: 0.0000 (0.0000)  time: 251.0521  data: 201.3155
🚀 Starting data_iter_step 1 (DataLoader iteration took 16.137s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 13.633s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.268s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.601s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.594s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.653s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.603s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 0.597s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 0.651s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.271s)...
Epoch: [0]  [10/78]  eta: 0:30:29  loss: 7.0312 (7.0398)  lr: 0.0000 (0.0000)  time: 26.9089  data: 18.3019
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.344s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.286s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.661s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.258s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.685s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 0.242s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 0.597s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.656s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.634s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.600s)...
Epoch: [0]  [20/78]  eta: 0:14:02  loss: 7.0312 (7.0372)  lr: 0.0000 (0.0000)  time: 2.7048  data: 0.0006
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.397s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.314s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.669s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 0.616s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 0.303s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.619s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.645s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.608s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.575s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.328s)...
Epoch: [0]  [30/78]  eta: 0:08:06  loss: 7.0312 (7.0373)  lr: 0.0001 (0.0000)  time: 0.9109  data: 0.0006
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.364s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 0.627s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 0.267s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.339s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.312s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.210s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.596s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.648s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.604s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 0.313s)...
Epoch: [0]  [40/78]  eta: 0:04:59  loss: 7.0312 (7.0305)  lr: 0.0001 (0.0001)  time: 0.8994  data: 0.0005
🚀 Starting data_iter_step 41 (DataLoader iteration took 0.307s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.292s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.207s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.675s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.391s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.612s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.271s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 0.318s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 0.650s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.674s)...
Epoch: [0]  [50/78]  eta: 0:03:02  loss: 7.0000 (7.0233)  lr: 0.0001 (0.0001)  time: 0.9201  data: 0.0005
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.664s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.584s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.305s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.176s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.583s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 4.212s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 1.617s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.175s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.249s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.621s)...
Epoch: [0]  [60/78]  eta: 0:01:42  loss: 7.0000 (7.0164)  lr: 0.0001 (0.0001)  time: 1.1833  data: 0.1948
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.288s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.679s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.602s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 4.606s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 1.606s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.352s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.657s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.273s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.333s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.620s)...
Epoch: [0]  [70/78]  eta: 0:00:40  loss: 6.9688 (7.0110)  lr: 0.0002 (0.0001)  time: 1.4341  data: 0.3957
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.684s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 1.302s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 1.095s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.613s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.611s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.257s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.595s)...
Epoch: [0]  [77/78]  eta: 0:00:04  loss: 6.9688 (7.0064)  lr: 0.0002 (0.0001)  time: 1.2241  data: 0.2331
Epoch: [0] Total time: 0:06:08 (4.7261 s / it)
Averaged stats: loss: 6.9688 (7.0256)  lr: 0.0002 (0.0001)
🏁 train_one_epoch total time: 368.70s
✅ Training epoch 0 completed in 368.70s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
📊 First validation enumerate() call took 93.95s
🔍 Starting validation batch 0 (DataLoader iteration took 0.000s)...
✅ Validation batch 0 completed in 8.923s
Test:  [0/3]  eta: 0:05:08  loss: 6.9688 (6.9688)  acc1: 0.2598 (0.2598)  acc5: 1.0391 (1.0391)  time: 102.8760  data: 93.9519
Test:  [2/3]  eta: 0:00:37  loss: 6.9688 (6.9479)  acc1: 0.2598 (0.2551)  acc5: 1.0391 (1.0205)  time: 37.2047  data: 31.3644
Test: Total time: 0:01:51 (37.2200 s / it)
* Acc@1 0.159 Acc@5 0.770 loss 6.917
✅ Validation completed in 112.33s
Accuracy of the model on the 50000 test images: 0.2%
Max accuracy: 0.16%
🏁 Epoch 0 total time: 481.03s
Starting epoch 1 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(1)...
✅ original_train_sampler.set_epoch(1) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 1
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
📊 First enumerate() call took 248.56s
🚀 Starting data_iter_step 0 (DataLoader iteration took 361.343s)...
Epoch: [1]  [ 0/78]  eta: 5:24:58  loss: 6.9375 (6.9375)  lr: 0.0002 (0.0002)  time: 249.9862  data: 248.5631
🚀 Starting data_iter_step 1 (DataLoader iteration took 0.792s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.571s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.274s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.315s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.281s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.649s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.667s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 5.252s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 1.076s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.631s)...
Epoch: [1]  [10/78]  eta: 0:27:11  loss: 6.9688 (6.9716)  lr: 0.0002 (0.0002)  time: 23.9979  data: 23.0144
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.237s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.340s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.648s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.347s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.626s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 5.350s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 1.337s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.291s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.259s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.674s)...
Epoch: [1]  [20/78]  eta: 0:12:49  loss: 6.9688 (6.9568)  lr: 0.0002 (0.0002)  time: 1.4298  data: 0.4686
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.649s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.583s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.629s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 4.845s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 1.341s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.308s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.680s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.296s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.647s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.256s)...
Epoch: [1]  [30/78]  eta: 0:07:33  loss: 6.9375 (6.9526)  lr: 0.0003 (0.0002)  time: 1.4472  data: 0.4459
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.318s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 4.349s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 1.818s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.586s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.260s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.653s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.378s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.614s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.586s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 4.339s)...
Epoch: [1]  [40/78]  eta: 0:04:49  loss: 6.9375 (6.9482)  lr: 0.0003 (0.0003)  time: 1.6811  data: 0.5913
🚀 Starting data_iter_step 41 (DataLoader iteration took 2.087s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.302s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.641s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.609s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.276s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.211s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.261s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 4.445s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 1.756s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.597s)...
Epoch: [1]  [50/78]  eta: 0:02:59  loss: 6.9375 (6.9449)  lr: 0.0003 (0.0003)  time: 1.6764  data: 0.5760
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.631s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.644s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.292s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.580s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.378s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 4.293s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 2.083s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.189s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.188s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.247s)...
Epoch: [1]  [60/78]  eta: 0:01:40  loss: 6.9375 (6.9421)  lr: 0.0003 (0.0003)  time: 1.4342  data: 0.3754
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.178s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.312s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.309s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 3.913s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 2.250s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.247s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.614s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.640s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.298s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.609s)...
Epoch: [1]  [70/78]  eta: 0:00:39  loss: 6.9062 (6.9393)  lr: 0.0004 (0.0003)  time: 1.4181  data: 0.3482
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.223s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 0.775s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 2.372s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.339s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.291s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.574s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.251s)...
Epoch: [1]  [77/78]  eta: 0:00:04  loss: 6.9375 (6.9379)  lr: 0.0004 (0.0003)  time: 1.2375  data: 0.1894
Epoch: [1] Total time: 0:06:03 (4.6539 s / it)
Averaged stats: loss: 6.9375 (6.9231)  lr: 0.0004 (0.0003)
🏁 train_one_epoch total time: 363.01s
✅ Training epoch 1 completed in 363.01s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
📊 First validation enumerate() call took 92.45s
🔍 Starting validation batch 0 (DataLoader iteration took 456.178s)...
✅ Validation batch 0 completed in 0.106s
Test:  [0/3]  eta: 0:04:37  loss: 6.8750 (6.8750)  acc1: 0.5195 (0.5195)  acc5: 1.3047 (1.3047)  time: 92.5581  data: 92.4514
Test:  [2/3]  eta: 0:00:30  loss: 6.8750 (6.8854)  acc1: 0.2598 (0.3827)  acc5: 1.3047 (1.4079)  time: 30.8877  data: 30.8176
Test: Total time: 0:01:32 (30.8881 s / it)
* Acc@1 0.352 Acc@5 1.357 loss 6.792
✅ Validation completed in 94.44s
Accuracy of the model on the 50000 test images: 0.4%
Max accuracy: 0.35%
🏁 Epoch 1 total time: 457.45s
Starting epoch 2 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(2)...
✅ original_train_sampler.set_epoch(2) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 2
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
📊 First enumerate() call took 246.56s
🚀 Starting data_iter_step 0 (DataLoader iteration took 341.629s)...
Epoch: [2]  [ 0/78]  eta: 5:25:46  loss: 6.9688 (6.9688)  lr: 0.0004 (0.0004)  time: 250.5995  data: 246.5625
🚀 Starting data_iter_step 1 (DataLoader iteration took 3.666s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.682s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.616s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.268s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.614s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.597s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.666s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 3.589s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 2.613s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.684s)...
Epoch: [2]  [10/78]  eta: 0:27:17  loss: 6.9062 (6.9091)  lr: 0.0004 (0.0004)  time: 24.0867  data: 22.7111
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.622s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.669s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.660s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.259s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.644s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 3.572s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 2.445s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.323s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.591s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.635s)...
Epoch: [2]  [20/78]  eta: 0:12:49  loss: 6.9062 (6.9122)  lr: 0.0004 (0.0004)  time: 1.4084  data: 0.3102
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.663s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.335s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.266s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 3.783s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 2.669s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.329s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.652s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.713s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.266s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.350s)...
Epoch: [2]  [30/78]  eta: 0:07:34  loss: 6.9062 (6.9143)  lr: 0.0005 (0.0004)  time: 1.4210  data: 0.3028
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.313s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 3.128s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 3.237s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.632s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.180s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.591s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.257s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.376s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.593s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 2.867s)...
Epoch: [2]  [40/78]  eta: 0:04:49  loss: 6.9062 (6.9139)  lr: 0.0005 (0.0005)  time: 1.6851  data: 0.3877
🚀 Starting data_iter_step 41 (DataLoader iteration took 2.858s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.197s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.290s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.184s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.573s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.621s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.216s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 3.243s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 2.966s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.308s)...
Epoch: [2]  [50/78]  eta: 0:02:59  loss: 6.9062 (6.9112)  lr: 0.0005 (0.0005)  time: 1.6710  data: 0.3626
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.710s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.683s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.258s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.272s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.627s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 2.493s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 3.859s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.241s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.262s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.630s)...
Epoch: [2]  [60/78]  eta: 0:01:40  loss: 6.8750 (6.9078)  lr: 0.0005 (0.0005)  time: 1.4330  data: 0.2404
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.294s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.613s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.605s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 2.617s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 4.188s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.264s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.544s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.630s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.369s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.313s)...
Epoch: [2]  [70/78]  eta: 0:00:40  loss: 6.9062 (6.9076)  lr: 0.0006 (0.0005)  time: 1.4363  data: 0.2086
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.603s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 0.305s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 2.380s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.627s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.218s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.278s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.252s)...
Epoch: [2]  [77/78]  eta: 0:00:04  loss: 6.8750 (6.9038)  lr: 0.0006 (0.0005)  time: 1.2460  data: 0.0989
Epoch: [2] Total time: 0:06:03 (4.6595 s / it)
Averaged stats: loss: 6.8750 (6.9231)  lr: 0.0006 (0.0005)
🏁 train_one_epoch total time: 363.45s
✅ Training epoch 2 completed in 363.45s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
📊 First validation enumerate() call took 93.65s
🔍 Starting validation batch 0 (DataLoader iteration took 458.867s)...
✅ Validation batch 0 completed in 0.093s
Test:  [0/3]  eta: 0:04:41  loss: 6.7500 (6.7500)  acc1: 0.2598 (0.2598)  acc5: 2.0781 (2.0781)  time: 93.7398  data: 93.6455
Test:  [2/3]  eta: 0:00:31  loss: 6.7812 (6.7917)  acc1: 0.2598 (0.3827)  acc5: 0.7812 (1.4041)  time: 31.2733  data: 31.2156
Test: Total time: 0:01:33 (31.2737 s / it)
* Acc@1 0.500 Acc@5 2.000 loss 6.625
✅ Validation completed in 94.42s
Accuracy of the model on the 50000 test images: 0.5%
Max accuracy: 0.50%
🏁 Epoch 2 total time: 457.87s
Starting epoch 3 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(3)...
✅ original_train_sampler.set_epoch(3) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 3
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
