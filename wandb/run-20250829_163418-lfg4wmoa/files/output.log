W&B online run started. URL: https://wandb.ai/ttl/tpu-vit/runs/lfg4wmoa
TPU mode: Using num_workers=0 to avoid pickle issues, will use MpDeviceLoader for parallelism
Mixup is activated!
WARNING:timm.models._builder:No pretrained configuration specified for my_vit_b model. Using a default. Please add a config to the model pretrained_cfg registry or pass explicitly.
Forcing XLA synchronization after model.to(device)...
XLA mark_step() after model.to(device) completed
Forcing XLA synchronization before parameter counting...
XLA mark_step() completed
TPU spawned process: world_size = 64
Calculated total_batch_size = 16384
Number of training examples = 1281167
LR = 0.00400000
Batch size = 16384
Update frequent = 1
Number of training steps per epoch = 78
TPU multihost mode: XLA handles data distribution internally
About to create optimizer...
TPU mode: Using name-only parameter grouping to avoid XLA compilation
TPU mode: Collecting parameter names...
TPU mode: Found 152 trainable parameters
TPU mode: Grouping parameters by names...
Processing parameter 1/152: cls_token
Processing parameter 51/152: blocks.3.mlp.fc2.weight
Processing parameter 101/152: blocks.8.norm1.weight
Processing parameter 151/152: head.weight
TPU mode: Parameter names grouped successfully
TPU mode: Mapping names to tensors...
TPU mode: All 152 parameters mapped successfully
Parameter iteration completed! Processed 152 parameters.
TPU mode: Created 2 parameter groups, returning optimizer groups...
Parameter groups created successfully
Optimizer created successfully
TPU mode: Skipping loss scaler (XLA handles mixed precision)
TPU mode: About to set loss_scaler = None...
TPU mode: Loss scaler set to None
About to create Cosine LR scheduler...
Set warmup steps = 1560
LR scheduler created successfully
About to continue to weight decay scheduler...
About to check args.weight_decay_end...
Directly setting weight_decay_end to avoid freeze...
weight_decay_end set to: 0.05
About to call cosine_scheduler for weight decay...
Calling with: wd=0.05, wd_end=0.05, epochs=100, steps_per_epoch=78
Set warmup steps = 0
cosine_scheduler completed, about to calculate min/max...
Weight decay schedule created: 0.05 -> 0.05
About to create criterion...
Created SoftTargetCrossEntropy criterion
criterion = SoftTargetCrossEntropy()
TPU mode: Skipping warmup (caused shape errors), will compile on first iteration
About to call auto_load_model...
auto_load_model completed
About to define get_eval_model helper function...
get_eval_model function defined
About to set max_accuracy...
max_accuracy initialized
🚀 Creating MpDeviceLoader for training DataLoader (TPU optimization)...
✅ Training MpDeviceLoader created successfully
🚀 Creating MpDeviceLoader for validation DataLoader (TPU optimization)...
✅ Validation MpDeviceLoader created successfully
Start training for 100 epochs
About to record start_time...
About to enter training loop...
Starting epoch 0 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(0)...
✅ original_train_sampler.set_epoch(0) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 0
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 216.95s
🚀 Starting data_iter_step 0 (DataLoader iteration took 0.000s)...
Epoch: [0] [0/78] eta: 0:01:18 loss: 7.0938 lr: 0.000000 time: 21.5803 data: 0.0000
🚀 Starting data_iter_step 1 (DataLoader iteration took 23.693s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 13.094s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.273s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.632s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.641s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.662s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.635s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 0.683s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 0.373s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.606s)...
Epoch: [0] [10/78] eta: 0:00:42 loss: 7.0625 lr: 0.000026 time: 0.6190 data: 0.6062
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.281s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.650s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.601s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.631s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.636s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 0.652s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 0.646s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.230s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.609s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.349s)...
Epoch: [0] [20/78] eta: 0:00:33 loss: 7.0312 lr: 0.000051 time: 0.5742 data: 0.3493
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.305s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.654s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.264s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 0.560s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 0.222s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.282s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.665s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.427s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.636s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.286s)...
Epoch: [0] [30/78] eta: 0:00:31 loss: 7.0000 lr: 0.000077 time: 0.6461 data: 0.2863
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.259s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 0.319s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 0.192s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.689s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.607s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.262s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.594s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.624s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.255s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 0.676s)...
Epoch: [0] [40/78] eta: 0:00:19 loss: 6.9688 lr: 0.000103 time: 0.5216 data: 0.6756
🚀 Starting data_iter_step 41 (DataLoader iteration took 0.382s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.663s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.547s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.625s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.585s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.336s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.326s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 0.230s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 0.633s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.293s)...
Epoch: [0] [50/78] eta: 0:00:07 loss: 6.9688 lr: 0.000128 time: 0.2572 data: 0.2931
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.589s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.669s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.593s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.411s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.254s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 4.115s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 1.996s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.600s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.238s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.329s)...
Epoch: [0] [60/78] eta: 0:00:05 loss: 6.9688 lr: 0.000154 time: 0.3162 data: 0.3286
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.617s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.176s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.174s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 4.246s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 1.868s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.614s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.634s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.662s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.258s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.177s)...
Epoch: [0] [70/78] eta: 0:00:02 loss: 6.9375 lr: 0.000180 time: 0.2727 data: 0.1774
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.654s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 1.388s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 1.738s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.282s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.584s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.333s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.670s)...
Averaged stats: loss: 6.9688 (7.0256)  lr: 0.0002 (0.0001)
🏁 train_one_epoch total time: 379.92s
✅ Training epoch 0 completed in 379.92s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 93.55s
🔍 Starting validation batch 0 (DataLoader iteration took 0.000s)...
Test: [0/3] loss: 6.9688 acc1: 0.2598 acc5: 0.7812 time: 9.1495 data: 0.0000
* Acc@1 0.184 Acc@5 0.816 loss 6.917
✅ Validation completed in 112.02s
Accuracy of the model on the 50000 test images: 0.2%
Max accuracy: 0.18%
🏁 Epoch 0 total time: 491.95s
Starting epoch 1 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(1)...
✅ original_train_sampler.set_epoch(1) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 1
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 247.95s
🚀 Starting data_iter_step 0 (DataLoader iteration took 360.285s)...
Epoch: [1] [0/78] eta: 0:01:18 loss: 6.9375 lr: 0.000200 time: 0.2837 data: 360.2853
🚀 Starting data_iter_step 1 (DataLoader iteration took 1.834s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.581s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.607s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.299s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.701s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.245s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.626s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 4.625s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 1.837s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.185s)...
Epoch: [1] [10/78] eta: 0:00:19 loss: 6.9688 lr: 0.000226 time: 0.2842 data: 0.1855
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.610s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.600s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.684s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.280s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.324s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 4.536s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 1.438s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.276s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.594s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.226s)...
Epoch: [1] [20/78] eta: 0:00:15 loss: 6.9375 lr: 0.000251 time: 0.2696 data: 0.2255
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.618s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.228s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.254s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 4.314s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 1.855s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.259s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.318s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.674s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.309s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.241s)...
Epoch: [1] [30/78] eta: 0:00:12 loss: 6.9062 lr: 0.000277 time: 0.2701 data: 0.2410
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.598s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 3.572s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 2.032s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.623s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.211s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.290s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.288s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.303s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.232s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 3.960s)...
Epoch: [1] [40/78] eta: 0:00:22 loss: 6.9375 lr: 0.000303 time: 0.5973 data: 3.9596
🚀 Starting data_iter_step 41 (DataLoader iteration took 2.021s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.292s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.615s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.610s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.254s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.288s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.389s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 4.044s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 2.123s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.175s)...
Epoch: [1] [50/78] eta: 0:00:17 loss: 6.9688 lr: 0.000328 time: 0.6120 data: 0.1746
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.320s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.314s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.660s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.608s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.605s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 3.945s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 2.203s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.655s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.279s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.232s)...
Epoch: [1] [60/78] eta: 0:00:04 loss: 6.9062 lr: 0.000354 time: 0.2692 data: 0.2319
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.652s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.658s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.630s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 3.751s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 2.679s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.654s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.260s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.264s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.594s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.606s)...
Epoch: [1] [70/78] eta: 0:00:05 loss: 6.9062 lr: 0.000380 time: 0.6270 data: 0.6056
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.275s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 0.609s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 2.351s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.221s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.330s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.611s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.330s)...
Averaged stats: loss: 6.9375 (6.9231)  lr: 0.0004 (0.0003)
🏁 train_one_epoch total time: 363.47s
✅ Training epoch 1 completed in 363.47s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 93.73s
🔍 Starting validation batch 0 (DataLoader iteration took 457.779s)...
Test: [0/3] loss: 6.8750 acc1: 0.2598 acc5: 0.7812 time: 0.0944 data: 457.7789
* Acc@1 0.312 Acc@5 1.367 loss 6.792
✅ Validation completed in 94.61s
Accuracy of the model on the 50000 test images: 0.3%
Max accuracy: 0.31%
🏁 Epoch 1 total time: 458.08s
Starting epoch 2 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(2)...
✅ original_train_sampler.set_epoch(2) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 2
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 248.81s
🚀 Starting data_iter_step 0 (DataLoader iteration took 343.719s)...
Epoch: [2] [0/78] eta: 0:01:18 loss: 6.9375 lr: 0.000400 time: 0.2971 data: 343.7195
🚀 Starting data_iter_step 1 (DataLoader iteration took 1.261s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.658s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.701s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.633s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.651s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.212s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.328s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 5.112s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 1.581s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.657s)...
Epoch: [2] [10/78] eta: 0:00:43 loss: 6.8750 lr: 0.000426 time: 0.6397 data: 0.6575
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.236s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.309s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.181s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.620s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.611s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 4.449s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 1.320s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.662s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.681s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.293s)...
Epoch: [2] [20/78] eta: 0:00:37 loss: 6.9375 lr: 0.000452 time: 0.6430 data: 0.2933
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.243s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.230s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.279s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 5.074s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 1.458s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.286s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.657s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.557s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.654s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.213s)...
Epoch: [2] [30/78] eta: 0:00:29 loss: 6.9062 lr: 0.000477 time: 0.6167 data: 0.2127
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.203s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 4.990s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 1.368s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.656s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.284s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.286s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.242s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.400s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.274s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 4.225s)...
Epoch: [2] [40/78] eta: 0:00:24 loss: 6.8750 lr: 0.000503 time: 0.6334 data: 4.2255
🚀 Starting data_iter_step 41 (DataLoader iteration took 1.628s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.665s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.628s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.638s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.213s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.582s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.382s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 4.328s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 1.919s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.339s)...
Epoch: [2] [50/78] eta: 0:00:07 loss: 6.9062 lr: 0.000529 time: 0.2724 data: 0.3393
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.587s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.244s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.313s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.236s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.291s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 3.776s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 2.687s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.571s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.699s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.598s)...
Epoch: [2] [60/78] eta: 0:00:04 loss: 6.8750 lr: 0.000554 time: 0.2726 data: 0.5977
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.706s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.215s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.613s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 3.297s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 2.457s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.311s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.641s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.568s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.639s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.344s)...
Epoch: [2] [70/78] eta: 0:00:05 loss: 6.8438 lr: 0.000580 time: 0.6374 data: 0.3437
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.222s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 0.814s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 2.675s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.653s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.174s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.300s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.283s)...
Averaged stats: loss: 6.8750 (6.9231)  lr: 0.0006 (0.0005)
🏁 train_one_epoch total time: 363.84s
✅ Training epoch 2 completed in 363.84s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 93.84s
🔍 Starting validation batch 0 (DataLoader iteration took 458.396s)...
Test: [0/3] loss: 6.7500 acc1: 0.2598 acc5: 2.0781 time: 0.0961 data: 458.3958
* Acc@1 0.508 Acc@5 1.980 loss 6.625
✅ Validation completed in 94.51s
Accuracy of the model on the 50000 test images: 0.5%
Max accuracy: 0.51%
🏁 Epoch 2 total time: 458.35s
Starting epoch 3 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(3)...
✅ original_train_sampler.set_epoch(3) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 3
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 248.73s
🚀 Starting data_iter_step 0 (DataLoader iteration took 343.505s)...
Epoch: [3] [0/78] eta: 0:01:18 loss: 6.9375 lr: 0.000600 time: 0.2900 data: 343.5051
🚀 Starting data_iter_step 1 (DataLoader iteration took 1.016s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.746s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.638s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.282s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.661s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.617s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.617s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 5.333s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 0.668s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.353s)...
Epoch: [3] [10/78] eta: 0:00:18 loss: 6.8750 lr: 0.000626 time: 0.2758 data: 0.3527
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.556s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.305s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.633s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.605s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.627s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 5.515s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 0.802s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.310s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.583s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.314s)...
Epoch: [3] [20/78] eta: 0:00:15 loss: 6.9062 lr: 0.000652 time: 0.2679 data: 0.3138
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.626s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.209s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.246s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 5.954s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 0.598s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.633s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.614s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.294s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.308s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.652s)...
Epoch: [3] [30/78] eta: 0:00:31 loss: 6.9062 lr: 0.000677 time: 0.6540 data: 0.6518
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.246s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 5.932s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 0.248s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.301s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.273s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.366s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.261s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.296s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.356s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 5.833s)...
Epoch: [3] [40/78] eta: 0:00:27 loss: 6.9375 lr: 0.000703 time: 0.7168 data: 5.8333
🚀 Starting data_iter_step 41 (DataLoader iteration took 0.274s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.282s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.682s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.324s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.577s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.321s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.231s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 5.614s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 0.587s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.641s)...
Epoch: [3] [50/78] eta: 0:00:07 loss: 6.9062 lr: 0.000729 time: 0.2672 data: 0.6407
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.594s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.634s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.570s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.341s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.565s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 5.377s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 0.787s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.590s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.587s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.582s)...
Epoch: [3] [60/78] eta: 0:00:10 loss: 6.9062 lr: 0.000754 time: 0.5567 data: 0.5821
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.342s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.612s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.292s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 5.085s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 1.812s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.571s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.586s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.218s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.311s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.623s)...
Epoch: [3] [70/78] eta: 0:00:04 loss: 6.8750 lr: 0.000780 time: 0.6240 data: 0.6230
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.261s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 1.769s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 1.681s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.630s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.238s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.573s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.636s)...
Averaged stats: loss: 6.8750 (6.8718)  lr: 0.0008 (0.0007)
🏁 train_one_epoch total time: 362.83s
✅ Training epoch 3 completed in 362.83s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 92.88s
🔍 Starting validation batch 0 (DataLoader iteration took 456.207s)...
Test: [0/3] loss: 6.7500 acc1: 0.2598 acc5: 3.1250 time: 0.1201 data: 456.2074
* Acc@1 0.564 Acc@5 2.367 loss 6.583
✅ Validation completed in 94.51s
Accuracy of the model on the 50000 test images: 0.6%
Max accuracy: 0.56%
🏁 Epoch 3 total time: 457.35s
Starting epoch 4 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(4)...
✅ original_train_sampler.set_epoch(4) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 4
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 247.49s
🚀 Starting data_iter_step 0 (DataLoader iteration took 342.202s)...
Epoch: [4] [0/78] eta: 0:01:18 loss: 6.8438 lr: 0.000801 time: 0.6656 data: 342.2025
🚀 Starting data_iter_step 1 (DataLoader iteration took 2.260s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.625s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.292s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.630s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.258s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.252s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.233s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 3.528s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 2.911s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.638s)...
Epoch: [4] [10/78] eta: 0:00:41 loss: 6.8750 lr: 0.000826 time: 0.6090 data: 0.6381
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.270s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.212s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.272s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.616s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.212s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 3.544s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 2.473s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.216s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.613s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.367s)...
Epoch: [4] [20/78] eta: 0:00:15 loss: 6.8750 lr: 0.000852 time: 0.2674 data: 0.3669
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.587s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.310s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.624s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 3.763s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 2.196s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.617s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.641s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.667s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.194s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.678s)...
Epoch: [4] [30/78] eta: 0:00:30 loss: 6.8750 lr: 0.000877 time: 0.6268 data: 0.6778
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.268s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 3.670s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 2.897s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.316s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.608s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.339s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.277s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.654s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.269s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 2.879s)...
Epoch: [4] [40/78] eta: 0:00:10 loss: 6.8750 lr: 0.000903 time: 0.2787 data: 2.8788
🚀 Starting data_iter_step 41 (DataLoader iteration took 3.165s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.277s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.668s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.305s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.312s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.649s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.561s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 3.314s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 3.543s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.708s)...
Epoch: [4] [50/78] eta: 0:00:17 loss: 6.9062 lr: 0.000929 time: 0.6149 data: 0.7084
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.337s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.287s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.288s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.274s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.264s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 2.949s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 2.884s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.288s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.632s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.655s)...
Epoch: [4] [60/78] eta: 0:00:11 loss: 6.8125 lr: 0.000954 time: 0.6481 data: 0.6549
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.211s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.625s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.274s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 3.125s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 3.599s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.653s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.594s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.590s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.223s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.585s)...
Epoch: [4] [70/78] eta: 0:00:02 loss: 6.8438 lr: 0.000980 time: 0.2704 data: 0.5848
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.576s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 0.566s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 2.719s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.231s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.625s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.283s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.289s)...
Averaged stats: loss: 6.8125 (6.8718)  lr: 0.0010 (0.0009)
🏁 train_one_epoch total time: 363.08s
✅ Training epoch 4 completed in 363.08s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 93.77s
🔍 Starting validation batch 0 (DataLoader iteration took 458.253s)...
Test: [0/3] loss: 6.6250 acc1: 0.5195 acc5: 1.8203 time: 0.0991 data: 458.2534
* Acc@1 0.745 Acc@5 3.102 loss 6.417
✅ Validation completed in 94.50s
Accuracy of the model on the 50000 test images: 0.7%
Max accuracy: 0.74%
🏁 Epoch 4 total time: 457.58s
Starting epoch 5 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(5)...
✅ original_train_sampler.set_epoch(5) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 5
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 248.22s
🚀 Starting data_iter_step 0 (DataLoader iteration took 343.340s)...
Epoch: [5] [0/78] eta: 0:01:18 loss: 6.8750 lr: 0.001001 time: 0.2751 data: 343.3402
🚀 Starting data_iter_step 1 (DataLoader iteration took 1.339s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.614s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.642s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.626s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.638s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.383s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.227s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 5.064s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 1.093s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.347s)...
Epoch: [5] [10/78] eta: 0:00:45 loss: 6.8750 lr: 0.001026 time: 0.6707 data: 0.3472
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.268s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.633s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.210s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.604s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.194s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 5.015s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 1.579s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.252s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.226s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.624s)...
Epoch: [5] [20/78] eta: 0:00:14 loss: 6.7812 lr: 0.001052 time: 0.2505 data: 0.6238
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.655s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.203s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.432s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 4.074s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 2.239s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.298s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.558s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.656s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.223s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.573s)...
Epoch: [5] [30/78] eta: 0:00:13 loss: 6.7812 lr: 0.001078 time: 0.2898 data: 0.5728
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.619s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 4.197s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 1.721s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.209s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.318s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.611s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.557s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.652s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.219s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 4.309s)...
Epoch: [5] [40/78] eta: 0:00:11 loss: 6.8750 lr: 0.001103 time: 0.2897 data: 4.3090
🚀 Starting data_iter_step 41 (DataLoader iteration took 2.196s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.620s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.634s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.252s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.638s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.299s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.600s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 3.753s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 2.044s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.669s)...
Epoch: [5] [50/78] eta: 0:00:15 loss: 6.8125 lr: 0.001129 time: 0.5597 data: 0.6691
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.387s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.596s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.219s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.296s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.672s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 3.851s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 2.311s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.234s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.574s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.651s)...
Epoch: [5] [60/78] eta: 0:00:04 loss: 6.8438 lr: 0.001155 time: 0.2738 data: 0.6514
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.622s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.680s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.312s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 3.884s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 1.871s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.221s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.254s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.606s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.218s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.651s)...
Epoch: [5] [70/78] eta: 0:00:05 loss: 6.7812 lr: 0.001180 time: 0.6441 data: 0.6514
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.268s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 0.931s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 2.314s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.183s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.348s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.639s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.304s)...
Averaged stats: loss: 6.7812 (6.8205)  lr: 0.0012 (0.0011)
🏁 train_one_epoch total time: 362.33s
✅ Training epoch 5 completed in 362.33s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 93.47s
🔍 Starting validation batch 0 (DataLoader iteration took 456.345s)...
Test: [0/3] loss: 6.5312 acc1: 0.5195 acc5: 3.1250 time: 0.0987 data: 456.3452
* Acc@1 1.219 Acc@5 4.531 loss 6.250
✅ Validation completed in 94.29s
Accuracy of the model on the 50000 test images: 1.2%
Max accuracy: 1.22%
🏁 Epoch 5 total time: 456.62s
Starting epoch 6 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(6)...
✅ original_train_sampler.set_epoch(6) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 6
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 248.80s
🚀 Starting data_iter_step 0 (DataLoader iteration took 343.417s)...
Epoch: [6] [0/78] eta: 0:01:18 loss: 6.7188 lr: 0.001201 time: 0.2843 data: 343.4172
🚀 Starting data_iter_step 1 (DataLoader iteration took 0.975s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.635s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.233s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.324s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.199s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.571s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.305s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 5.087s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 0.767s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.314s)...
Epoch: [6] [10/78] eta: 0:00:36 loss: 6.7812 lr: 0.001226 time: 0.5411 data: 0.3137
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.378s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.218s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.638s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.176s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.615s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 5.265s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 1.549s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.276s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.175s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.560s)...
Epoch: [6] [20/78] eta: 0:00:16 loss: 6.6250 lr: 0.001252 time: 0.2766 data: 0.5598
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.622s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.622s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.612s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 4.617s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 0.996s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.298s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.615s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.558s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.615s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.271s)...
Epoch: [6] [30/78] eta: 0:00:33 loss: 6.7500 lr: 0.001278 time: 0.6989 data: 0.2709
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.229s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 4.658s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 1.566s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.336s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.610s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.594s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.404s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.677s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.627s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 5.034s)...
Epoch: [6] [40/78] eta: 0:00:25 loss: 6.7500 lr: 0.001303 time: 0.6686 data: 5.0337
🚀 Starting data_iter_step 41 (DataLoader iteration took 0.843s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.255s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.246s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.629s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.297s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.584s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.643s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 5.336s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 1.238s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.264s)...
Epoch: [6] [50/78] eta: 0:00:07 loss: 6.7500 lr: 0.001329 time: 0.2686 data: 0.2636
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.635s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.336s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.635s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.350s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.682s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 5.106s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 1.002s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.252s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.296s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.302s)...
Epoch: [6] [60/78] eta: 0:00:04 loss: 6.7188 lr: 0.001355 time: 0.2687 data: 0.3022
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.611s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.271s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.318s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 5.410s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 1.388s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.637s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.663s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.314s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.624s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.609s)...
Epoch: [6] [70/78] eta: 0:00:02 loss: 6.8125 lr: 0.001380 time: 0.2637 data: 0.6093
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.581s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 1.835s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 0.946s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.624s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.603s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.602s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.334s)...
Averaged stats: loss: 6.7500 (6.7692)  lr: 0.0014 (0.0013)
🏁 train_one_epoch total time: 362.58s
✅ Training epoch 6 completed in 362.58s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 93.81s
🔍 Starting validation batch 0 (DataLoader iteration took 457.034s)...
Test: [0/3] loss: 6.3750 acc1: 1.8203 acc5: 7.0312 time: 0.0861 data: 457.0343
* Acc@1 2.122 Acc@5 6.612 loss 6.125
✅ Validation completed in 94.59s
Accuracy of the model on the 50000 test images: 2.1%
Max accuracy: 2.12%
🏁 Epoch 6 total time: 457.17s
Starting epoch 7 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(7)...
✅ original_train_sampler.set_epoch(7) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 7
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 248.84s
🚀 Starting data_iter_step 0 (DataLoader iteration took 343.707s)...
Epoch: [7] [0/78] eta: 0:01:18 loss: 6.8438 lr: 0.001401 time: 0.6408 data: 343.7070
🚀 Starting data_iter_step 1 (DataLoader iteration took 1.037s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.591s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.612s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.262s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.230s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.607s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.625s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 4.739s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 1.720s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.582s)...
Epoch: [7] [10/78] eta: 0:00:41 loss: 6.6875 lr: 0.001427 time: 0.6109 data: 0.5820
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.311s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.274s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.287s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.620s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.674s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 4.613s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 1.123s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.260s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.680s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.586s)...
Epoch: [7] [20/78] eta: 0:00:35 loss: 6.7812 lr: 0.001452 time: 0.6079 data: 0.5863
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.348s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.284s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.301s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 4.381s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 1.838s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.661s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.272s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.633s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.356s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.267s)...
Epoch: [7] [30/78] eta: 0:00:23 loss: 6.6250 lr: 0.001478 time: 0.4932 data: 0.2668
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.407s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 4.314s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 2.097s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.303s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.252s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.690s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.616s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.648s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.250s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 4.174s)...
Epoch: [7] [40/78] eta: 0:00:10 loss: 6.7188 lr: 0.001504 time: 0.2772 data: 4.1737
🚀 Starting data_iter_step 41 (DataLoader iteration took 2.493s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.236s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.615s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.277s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.674s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.235s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.658s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 3.660s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 2.421s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.634s)...
Epoch: [7] [50/78] eta: 0:00:17 loss: 6.7812 lr: 0.001529 time: 0.6399 data: 0.6344
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.254s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.350s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.623s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.329s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.331s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 3.579s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 2.033s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.207s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.191s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.608s)...
Epoch: [7] [60/78] eta: 0:00:10 loss: 6.6250 lr: 0.001555 time: 0.5557 data: 0.6079
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.368s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.250s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.625s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 3.835s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 2.679s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.645s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.284s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.653s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.604s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.264s)...
Epoch: [7] [70/78] eta: 0:00:05 loss: 6.7500 lr: 0.001581 time: 0.6451 data: 0.2639
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.194s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 0.291s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 2.447s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.238s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.616s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.627s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.632s)...
Averaged stats: loss: 6.6562 (6.7179)  lr: 0.0016 (0.0015)
🏁 train_one_epoch total time: 364.08s
✅ Training epoch 7 completed in 364.08s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 93.72s
🔍 Starting validation batch 0 (DataLoader iteration took 458.417s)...
Test: [0/3] loss: 6.2500 acc1: 3.3750 acc5: 10.1875 time: 0.0970 data: 458.4172
* Acc@1 2.541 Acc@5 8.408 loss 6.000
✅ Validation completed in 94.51s
Accuracy of the model on the 50000 test images: 2.5%
Max accuracy: 2.54%
🏁 Epoch 7 total time: 458.59s
Starting epoch 8 (delay since last epoch: 0.00s)...
Setting sampler epoch...
About to call original_train_sampler.set_epoch(8)...
✅ original_train_sampler.set_epoch(8) completed in 0.00s
Setting wandb steps...
About to call train_one_epoch...
🎯 train_one_epoch called for epoch 8
About to zero_grad optimizer...
About to start data loader loop...
About to call enumerate(metric_logger.log_every(...))...
TPU mode: Using direct DataLoader enumeration to avoid metric_logger overhead
📊 First enumerate() call took 248.05s
🚀 Starting data_iter_step 0 (DataLoader iteration took 342.853s)...
Epoch: [8] [0/78] eta: 0:01:18 loss: 6.7500 lr: 0.001601 time: 0.3516 data: 342.8526
🚀 Starting data_iter_step 1 (DataLoader iteration took 2.115s)...
🚀 Starting data_iter_step 2 (DataLoader iteration took 0.268s)...
🚀 Starting data_iter_step 3 (DataLoader iteration took 0.593s)...
🚀 Starting data_iter_step 4 (DataLoader iteration took 0.655s)...
🚀 Starting data_iter_step 5 (DataLoader iteration took 0.277s)...
🚀 Starting data_iter_step 6 (DataLoader iteration took 0.641s)...
🚀 Starting data_iter_step 7 (DataLoader iteration took 0.311s)...
🚀 Starting data_iter_step 8 (DataLoader iteration took 4.424s)...
🚀 Starting data_iter_step 9 (DataLoader iteration took 1.768s)...
🚀 Starting data_iter_step 10 (DataLoader iteration took 0.603s)...
Epoch: [8] [10/78] eta: 0:00:19 loss: 6.6875 lr: 0.001627 time: 0.2839 data: 0.6033
🚀 Starting data_iter_step 11 (DataLoader iteration took 0.624s)...
🚀 Starting data_iter_step 12 (DataLoader iteration took 0.191s)...
🚀 Starting data_iter_step 13 (DataLoader iteration took 0.245s)...
🚀 Starting data_iter_step 14 (DataLoader iteration took 0.340s)...
🚀 Starting data_iter_step 15 (DataLoader iteration took 0.232s)...
🚀 Starting data_iter_step 16 (DataLoader iteration took 4.218s)...
🚀 Starting data_iter_step 17 (DataLoader iteration took 1.966s)...
🚀 Starting data_iter_step 18 (DataLoader iteration took 0.609s)...
🚀 Starting data_iter_step 19 (DataLoader iteration took 0.292s)...
🚀 Starting data_iter_step 20 (DataLoader iteration took 0.377s)...
Epoch: [8] [20/78] eta: 0:00:37 loss: 6.7500 lr: 0.001652 time: 0.6451 data: 0.3774
🚀 Starting data_iter_step 21 (DataLoader iteration took 0.214s)...
🚀 Starting data_iter_step 22 (DataLoader iteration took 0.280s)...
🚀 Starting data_iter_step 23 (DataLoader iteration took 0.385s)...
🚀 Starting data_iter_step 24 (DataLoader iteration took 4.067s)...
🚀 Starting data_iter_step 25 (DataLoader iteration took 1.693s)...
🚀 Starting data_iter_step 26 (DataLoader iteration took 0.315s)...
🚀 Starting data_iter_step 27 (DataLoader iteration took 0.335s)...
🚀 Starting data_iter_step 28 (DataLoader iteration took 0.659s)...
🚀 Starting data_iter_step 29 (DataLoader iteration took 0.606s)...
🚀 Starting data_iter_step 30 (DataLoader iteration took 0.254s)...
Epoch: [8] [30/78] eta: 0:00:28 loss: 6.5938 lr: 0.001678 time: 0.5950 data: 0.2542
🚀 Starting data_iter_step 31 (DataLoader iteration took 0.334s)...
🚀 Starting data_iter_step 32 (DataLoader iteration took 4.226s)...
🚀 Starting data_iter_step 33 (DataLoader iteration took 1.856s)...
🚀 Starting data_iter_step 34 (DataLoader iteration took 0.615s)...
🚀 Starting data_iter_step 35 (DataLoader iteration took 0.356s)...
🚀 Starting data_iter_step 36 (DataLoader iteration took 0.635s)...
🚀 Starting data_iter_step 37 (DataLoader iteration took 0.205s)...
🚀 Starting data_iter_step 38 (DataLoader iteration took 0.614s)...
🚀 Starting data_iter_step 39 (DataLoader iteration took 0.610s)...
🚀 Starting data_iter_step 40 (DataLoader iteration took 4.157s)...
Epoch: [8] [40/78] eta: 0:00:10 loss: 6.8125 lr: 0.001704 time: 0.2721 data: 4.1573
🚀 Starting data_iter_step 41 (DataLoader iteration took 2.423s)...
🚀 Starting data_iter_step 42 (DataLoader iteration took 0.624s)...
🚀 Starting data_iter_step 43 (DataLoader iteration took 0.284s)...
🚀 Starting data_iter_step 44 (DataLoader iteration took 0.198s)...
🚀 Starting data_iter_step 45 (DataLoader iteration took 0.677s)...
🚀 Starting data_iter_step 46 (DataLoader iteration took 0.637s)...
🚀 Starting data_iter_step 47 (DataLoader iteration took 0.267s)...
🚀 Starting data_iter_step 48 (DataLoader iteration took 3.567s)...
🚀 Starting data_iter_step 49 (DataLoader iteration took 2.346s)...
🚀 Starting data_iter_step 50 (DataLoader iteration took 0.582s)...
Epoch: [8] [50/78] eta: 0:00:15 loss: 6.7188 lr: 0.001729 time: 0.5599 data: 0.5821
🚀 Starting data_iter_step 51 (DataLoader iteration took 0.327s)...
🚀 Starting data_iter_step 52 (DataLoader iteration took 0.608s)...
🚀 Starting data_iter_step 53 (DataLoader iteration took 0.286s)...
🚀 Starting data_iter_step 54 (DataLoader iteration took 0.274s)...
🚀 Starting data_iter_step 55 (DataLoader iteration took 0.287s)...
🚀 Starting data_iter_step 56 (DataLoader iteration took 3.161s)...
🚀 Starting data_iter_step 57 (DataLoader iteration took 2.788s)...
🚀 Starting data_iter_step 58 (DataLoader iteration took 0.284s)...
🚀 Starting data_iter_step 59 (DataLoader iteration took 0.341s)...
🚀 Starting data_iter_step 60 (DataLoader iteration took 0.617s)...
Epoch: [8] [60/78] eta: 0:00:04 loss: 6.5938 lr: 0.001755 time: 0.2770 data: 0.6171
🚀 Starting data_iter_step 61 (DataLoader iteration took 0.677s)...
🚀 Starting data_iter_step 62 (DataLoader iteration took 0.342s)...
🚀 Starting data_iter_step 63 (DataLoader iteration took 0.613s)...
🚀 Starting data_iter_step 64 (DataLoader iteration took 2.629s)...
🚀 Starting data_iter_step 65 (DataLoader iteration took 3.269s)...
🚀 Starting data_iter_step 66 (DataLoader iteration took 0.181s)...
🚀 Starting data_iter_step 67 (DataLoader iteration took 0.270s)...
🚀 Starting data_iter_step 68 (DataLoader iteration took 0.637s)...
🚀 Starting data_iter_step 69 (DataLoader iteration took 0.278s)...
🚀 Starting data_iter_step 70 (DataLoader iteration took 0.204s)...
Epoch: [8] [70/78] eta: 0:00:04 loss: 6.7188 lr: 0.001781 time: 0.5502 data: 0.2039
🚀 Starting data_iter_step 71 (DataLoader iteration took 0.300s)...
🚀 Starting data_iter_step 72 (DataLoader iteration took 0.340s)...
🚀 Starting data_iter_step 73 (DataLoader iteration took 3.064s)...
🚀 Starting data_iter_step 74 (DataLoader iteration took 0.288s)...
🚀 Starting data_iter_step 75 (DataLoader iteration took 0.597s)...
🚀 Starting data_iter_step 76 (DataLoader iteration took 0.650s)...
🚀 Starting data_iter_step 77 (DataLoader iteration took 0.282s)...
Averaged stats: loss: 6.7188 (6.6667)  lr: 0.0018 (0.0017)
🏁 train_one_epoch total time: 363.40s
✅ Training epoch 8 completed in 363.40s
Checking checkpoint save conditions...
About to start validation...
Getting eval model...
About to call evaluate()...
Starting validation loop...
Validation DataLoader type: <class 'torch_xla.distributed.parallel_loader.MpDeviceLoader'>
Validation DataLoader batch count: 3
About to call enumerate(metric_logger.log_every(...)) for validation...
TPU mode: Using direct validation DataLoader enumeration to avoid metric_logger overhead
📊 First validation enumerate() call took 93.37s
🔍 Starting validation batch 0 (DataLoader iteration took 457.348s)...
Test: [0/3] loss: 6.2188 acc1: 3.1250 acc5: 10.9375 time: 0.1012 data: 457.3479
