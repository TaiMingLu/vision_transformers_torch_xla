W&B online run started. URL: https://wandb.ai/ttl/tpu-vit/runs/8ssdxmxi
Mixup is activated!
WARNING:timm.models._builder:No pretrained configuration specified for my_vit_b model. Using a default. Please add a config to the model pretrained_cfg registry or pass explicitly.
Forcing XLA synchronization after model.to(device)...
XLA mark_step() after model.to(device) completed
Using EMA with decay = 0.99990000
Forcing XLA synchronization before parameter counting...
XLA mark_step() completed
TPU spawned process: world_size = 32
Calculated total_batch_size = 2048
Number of training examples = 1281167
LR = 0.00400000
Batch size = 2048
Update frequent = 1
Number of training steps per epoch = 625
TPU multihost mode: XLA handles data distribution internally
About to create optimizer...
TPU mode: About to call xm.mark_step() before parameter iteration...
TPU mode: xm.mark_step() completed
About to iterate through named_parameters...
Processing parameter: cls_token
TPU mode: cls_token -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Creating new group: no_decay
Adding parameter cls_token to group no_decay
TPU mode: About to append parameter cls_token to group...
TPU mode: Carefully appending XLA tensor cls_token...
TPU mode: XLA mark_step() before append completed
Parameter cls_token appended to params list
Parameter name cls_token appended to names list
Parameter cls_token added successfully
Processing parameter: pos_embed
TPU mode: pos_embed -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter pos_embed to group no_decay
TPU mode: About to append parameter pos_embed to group...
TPU mode: Carefully appending XLA tensor pos_embed...
TPU mode: XLA mark_step() before append completed
Parameter pos_embed appended to params list
Parameter name pos_embed appended to names list
Parameter pos_embed added successfully
Processing parameter: patch_embed.proj.weight
TPU mode: patch_embed.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Creating new group: decay
Adding parameter patch_embed.proj.weight to group decay
TPU mode: About to append parameter patch_embed.proj.weight to group...
TPU mode: Carefully appending XLA tensor patch_embed.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter patch_embed.proj.weight appended to params list
Parameter name patch_embed.proj.weight appended to names list
Parameter patch_embed.proj.weight added successfully
Processing parameter: patch_embed.proj.bias
TPU mode: patch_embed.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter patch_embed.proj.bias to group no_decay
TPU mode: About to append parameter patch_embed.proj.bias to group...
TPU mode: Carefully appending XLA tensor patch_embed.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter patch_embed.proj.bias appended to params list
Parameter name patch_embed.proj.bias appended to names list
Parameter patch_embed.proj.bias added successfully
Processing parameter: blocks.0.norm1.weight
TPU mode: blocks.0.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.0.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.0.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.0.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.norm1.weight appended to params list
Parameter name blocks.0.norm1.weight appended to names list
Parameter blocks.0.norm1.weight added successfully
Processing parameter: blocks.0.norm1.bias
TPU mode: blocks.0.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.0.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.0.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.0.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.norm1.bias appended to params list
Parameter name blocks.0.norm1.bias appended to names list
Parameter blocks.0.norm1.bias added successfully
Processing parameter: blocks.0.attn.qkv.weight
TPU mode: blocks.0.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.0.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.0.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.0.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.attn.qkv.weight appended to params list
Parameter name blocks.0.attn.qkv.weight appended to names list
Parameter blocks.0.attn.qkv.weight added successfully
Processing parameter: blocks.0.attn.qkv.bias
TPU mode: blocks.0.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.0.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.0.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.0.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.attn.qkv.bias appended to params list
Parameter name blocks.0.attn.qkv.bias appended to names list
Parameter blocks.0.attn.qkv.bias added successfully
Processing parameter: blocks.0.attn.proj.weight
TPU mode: blocks.0.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.0.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.0.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.0.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.attn.proj.weight appended to params list
Parameter name blocks.0.attn.proj.weight appended to names list
Parameter blocks.0.attn.proj.weight added successfully
Processing parameter 10: blocks.0.attn.proj.bias
Processing parameter: blocks.0.attn.proj.bias
TPU mode: blocks.0.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.0.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.0.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.0.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.attn.proj.bias appended to params list
Parameter name blocks.0.attn.proj.bias appended to names list
Parameter blocks.0.attn.proj.bias added successfully
Processing parameter: blocks.0.norm2.weight
TPU mode: blocks.0.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.0.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.0.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.0.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.norm2.weight appended to params list
Parameter name blocks.0.norm2.weight appended to names list
Parameter blocks.0.norm2.weight added successfully
Processing parameter: blocks.0.norm2.bias
TPU mode: blocks.0.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.0.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.0.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.0.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.norm2.bias appended to params list
Parameter name blocks.0.norm2.bias appended to names list
Parameter blocks.0.norm2.bias added successfully
Processing parameter: blocks.0.mlp.fc1.weight
TPU mode: blocks.0.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.0.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.0.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.0.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.mlp.fc1.weight appended to params list
Parameter name blocks.0.mlp.fc1.weight appended to names list
Parameter blocks.0.mlp.fc1.weight added successfully
Processing parameter: blocks.0.mlp.fc1.bias
TPU mode: blocks.0.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.0.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.0.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.0.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.mlp.fc1.bias appended to params list
Parameter name blocks.0.mlp.fc1.bias appended to names list
Parameter blocks.0.mlp.fc1.bias added successfully
Processing parameter: blocks.0.mlp.fc2.weight
TPU mode: blocks.0.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.0.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.0.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.0.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.mlp.fc2.weight appended to params list
Parameter name blocks.0.mlp.fc2.weight appended to names list
Parameter blocks.0.mlp.fc2.weight added successfully
Processing parameter: blocks.0.mlp.fc2.bias
TPU mode: blocks.0.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.0.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.0.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.0.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.0.mlp.fc2.bias appended to params list
Parameter name blocks.0.mlp.fc2.bias appended to names list
Parameter blocks.0.mlp.fc2.bias added successfully
Processing parameter: blocks.1.norm1.weight
TPU mode: blocks.1.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.1.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.1.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.1.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.norm1.weight appended to params list
Parameter name blocks.1.norm1.weight appended to names list
Parameter blocks.1.norm1.weight added successfully
Processing parameter: blocks.1.norm1.bias
TPU mode: blocks.1.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.1.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.1.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.1.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.norm1.bias appended to params list
Parameter name blocks.1.norm1.bias appended to names list
Parameter blocks.1.norm1.bias added successfully
Processing parameter: blocks.1.attn.qkv.weight
TPU mode: blocks.1.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.1.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.1.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.1.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.attn.qkv.weight appended to params list
Parameter name blocks.1.attn.qkv.weight appended to names list
Parameter blocks.1.attn.qkv.weight added successfully
Processing parameter 20: blocks.1.attn.qkv.bias
Processing parameter: blocks.1.attn.qkv.bias
TPU mode: blocks.1.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.1.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.1.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.1.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.attn.qkv.bias appended to params list
Parameter name blocks.1.attn.qkv.bias appended to names list
Parameter blocks.1.attn.qkv.bias added successfully
Processing parameter: blocks.1.attn.proj.weight
TPU mode: blocks.1.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.1.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.1.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.1.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.attn.proj.weight appended to params list
Parameter name blocks.1.attn.proj.weight appended to names list
Parameter blocks.1.attn.proj.weight added successfully
Processing parameter: blocks.1.attn.proj.bias
TPU mode: blocks.1.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.1.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.1.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.1.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.attn.proj.bias appended to params list
Parameter name blocks.1.attn.proj.bias appended to names list
Parameter blocks.1.attn.proj.bias added successfully
Processing parameter: blocks.1.norm2.weight
TPU mode: blocks.1.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.1.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.1.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.1.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.norm2.weight appended to params list
Parameter name blocks.1.norm2.weight appended to names list
Parameter blocks.1.norm2.weight added successfully
Processing parameter: blocks.1.norm2.bias
TPU mode: blocks.1.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.1.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.1.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.1.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.norm2.bias appended to params list
Parameter name blocks.1.norm2.bias appended to names list
Parameter blocks.1.norm2.bias added successfully
Processing parameter: blocks.1.mlp.fc1.weight
TPU mode: blocks.1.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.1.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.1.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.1.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.mlp.fc1.weight appended to params list
Parameter name blocks.1.mlp.fc1.weight appended to names list
Parameter blocks.1.mlp.fc1.weight added successfully
Processing parameter: blocks.1.mlp.fc1.bias
TPU mode: blocks.1.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.1.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.1.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.1.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.mlp.fc1.bias appended to params list
Parameter name blocks.1.mlp.fc1.bias appended to names list
Parameter blocks.1.mlp.fc1.bias added successfully
Processing parameter: blocks.1.mlp.fc2.weight
TPU mode: blocks.1.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.1.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.1.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.1.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.mlp.fc2.weight appended to params list
Parameter name blocks.1.mlp.fc2.weight appended to names list
Parameter blocks.1.mlp.fc2.weight added successfully
Processing parameter: blocks.1.mlp.fc2.bias
TPU mode: blocks.1.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.1.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.1.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.1.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.1.mlp.fc2.bias appended to params list
Parameter name blocks.1.mlp.fc2.bias appended to names list
Parameter blocks.1.mlp.fc2.bias added successfully
Processing parameter: blocks.2.norm1.weight
TPU mode: blocks.2.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.2.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.2.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.2.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.norm1.weight appended to params list
Parameter name blocks.2.norm1.weight appended to names list
Parameter blocks.2.norm1.weight added successfully
Processing parameter 30: blocks.2.norm1.bias
Processing parameter: blocks.2.norm1.bias
TPU mode: blocks.2.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.2.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.2.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.2.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.norm1.bias appended to params list
Parameter name blocks.2.norm1.bias appended to names list
Parameter blocks.2.norm1.bias added successfully
Processing parameter: blocks.2.attn.qkv.weight
TPU mode: blocks.2.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.2.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.2.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.2.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.attn.qkv.weight appended to params list
Parameter name blocks.2.attn.qkv.weight appended to names list
Parameter blocks.2.attn.qkv.weight added successfully
Processing parameter: blocks.2.attn.qkv.bias
TPU mode: blocks.2.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.2.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.2.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.2.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.attn.qkv.bias appended to params list
Parameter name blocks.2.attn.qkv.bias appended to names list
Parameter blocks.2.attn.qkv.bias added successfully
Processing parameter: blocks.2.attn.proj.weight
TPU mode: blocks.2.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.2.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.2.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.2.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.attn.proj.weight appended to params list
Parameter name blocks.2.attn.proj.weight appended to names list
Parameter blocks.2.attn.proj.weight added successfully
Processing parameter: blocks.2.attn.proj.bias
TPU mode: blocks.2.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.2.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.2.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.2.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.attn.proj.bias appended to params list
Parameter name blocks.2.attn.proj.bias appended to names list
Parameter blocks.2.attn.proj.bias added successfully
Processing parameter: blocks.2.norm2.weight
TPU mode: blocks.2.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.2.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.2.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.2.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.norm2.weight appended to params list
Parameter name blocks.2.norm2.weight appended to names list
Parameter blocks.2.norm2.weight added successfully
Processing parameter: blocks.2.norm2.bias
TPU mode: blocks.2.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.2.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.2.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.2.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.norm2.bias appended to params list
Parameter name blocks.2.norm2.bias appended to names list
Parameter blocks.2.norm2.bias added successfully
Processing parameter: blocks.2.mlp.fc1.weight
TPU mode: blocks.2.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.2.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.2.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.2.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.mlp.fc1.weight appended to params list
Parameter name blocks.2.mlp.fc1.weight appended to names list
Parameter blocks.2.mlp.fc1.weight added successfully
Processing parameter: blocks.2.mlp.fc1.bias
TPU mode: blocks.2.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.2.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.2.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.2.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.mlp.fc1.bias appended to params list
Parameter name blocks.2.mlp.fc1.bias appended to names list
Parameter blocks.2.mlp.fc1.bias added successfully
Processing parameter: blocks.2.mlp.fc2.weight
TPU mode: blocks.2.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.2.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.2.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.2.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.mlp.fc2.weight appended to params list
Parameter name blocks.2.mlp.fc2.weight appended to names list
Parameter blocks.2.mlp.fc2.weight added successfully
Processing parameter 40: blocks.2.mlp.fc2.bias
Processing parameter: blocks.2.mlp.fc2.bias
TPU mode: blocks.2.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.2.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.2.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.2.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.2.mlp.fc2.bias appended to params list
Parameter name blocks.2.mlp.fc2.bias appended to names list
Parameter blocks.2.mlp.fc2.bias added successfully
Processing parameter: blocks.3.norm1.weight
TPU mode: blocks.3.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.3.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.3.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.3.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.norm1.weight appended to params list
Parameter name blocks.3.norm1.weight appended to names list
Parameter blocks.3.norm1.weight added successfully
Processing parameter: blocks.3.norm1.bias
TPU mode: blocks.3.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.3.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.3.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.3.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.norm1.bias appended to params list
Parameter name blocks.3.norm1.bias appended to names list
Parameter blocks.3.norm1.bias added successfully
Processing parameter: blocks.3.attn.qkv.weight
TPU mode: blocks.3.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.3.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.3.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.3.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.attn.qkv.weight appended to params list
Parameter name blocks.3.attn.qkv.weight appended to names list
Parameter blocks.3.attn.qkv.weight added successfully
Processing parameter: blocks.3.attn.qkv.bias
TPU mode: blocks.3.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.3.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.3.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.3.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.attn.qkv.bias appended to params list
Parameter name blocks.3.attn.qkv.bias appended to names list
Parameter blocks.3.attn.qkv.bias added successfully
Processing parameter: blocks.3.attn.proj.weight
TPU mode: blocks.3.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.3.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.3.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.3.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.attn.proj.weight appended to params list
Parameter name blocks.3.attn.proj.weight appended to names list
Parameter blocks.3.attn.proj.weight added successfully
Processing parameter: blocks.3.attn.proj.bias
TPU mode: blocks.3.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.3.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.3.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.3.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.attn.proj.bias appended to params list
Parameter name blocks.3.attn.proj.bias appended to names list
Parameter blocks.3.attn.proj.bias added successfully
Processing parameter: blocks.3.norm2.weight
TPU mode: blocks.3.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.3.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.3.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.3.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.norm2.weight appended to params list
Parameter name blocks.3.norm2.weight appended to names list
Parameter blocks.3.norm2.weight added successfully
Processing parameter: blocks.3.norm2.bias
TPU mode: blocks.3.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.3.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.3.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.3.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.norm2.bias appended to params list
Parameter name blocks.3.norm2.bias appended to names list
Parameter blocks.3.norm2.bias added successfully
Processing parameter: blocks.3.mlp.fc1.weight
TPU mode: blocks.3.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.3.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.3.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.3.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.mlp.fc1.weight appended to params list
Parameter name blocks.3.mlp.fc1.weight appended to names list
Parameter blocks.3.mlp.fc1.weight added successfully
Processing parameter 50: blocks.3.mlp.fc1.bias
Processing parameter: blocks.3.mlp.fc1.bias
TPU mode: blocks.3.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.3.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.3.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.3.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.mlp.fc1.bias appended to params list
Parameter name blocks.3.mlp.fc1.bias appended to names list
Parameter blocks.3.mlp.fc1.bias added successfully
Processing parameter: blocks.3.mlp.fc2.weight
TPU mode: blocks.3.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.3.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.3.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.3.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.mlp.fc2.weight appended to params list
Parameter name blocks.3.mlp.fc2.weight appended to names list
Parameter blocks.3.mlp.fc2.weight added successfully
Processing parameter: blocks.3.mlp.fc2.bias
TPU mode: blocks.3.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.3.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.3.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.3.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.3.mlp.fc2.bias appended to params list
Parameter name blocks.3.mlp.fc2.bias appended to names list
Parameter blocks.3.mlp.fc2.bias added successfully
Processing parameter: blocks.4.norm1.weight
TPU mode: blocks.4.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.4.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.4.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.4.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.norm1.weight appended to params list
Parameter name blocks.4.norm1.weight appended to names list
Parameter blocks.4.norm1.weight added successfully
Processing parameter: blocks.4.norm1.bias
TPU mode: blocks.4.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.4.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.4.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.4.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.norm1.bias appended to params list
Parameter name blocks.4.norm1.bias appended to names list
Parameter blocks.4.norm1.bias added successfully
Processing parameter: blocks.4.attn.qkv.weight
TPU mode: blocks.4.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.4.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.4.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.4.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.attn.qkv.weight appended to params list
Parameter name blocks.4.attn.qkv.weight appended to names list
Parameter blocks.4.attn.qkv.weight added successfully
Processing parameter: blocks.4.attn.qkv.bias
TPU mode: blocks.4.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.4.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.4.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.4.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.attn.qkv.bias appended to params list
Parameter name blocks.4.attn.qkv.bias appended to names list
Parameter blocks.4.attn.qkv.bias added successfully
Processing parameter: blocks.4.attn.proj.weight
TPU mode: blocks.4.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.4.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.4.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.4.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.attn.proj.weight appended to params list
Parameter name blocks.4.attn.proj.weight appended to names list
Parameter blocks.4.attn.proj.weight added successfully
Processing parameter: blocks.4.attn.proj.bias
TPU mode: blocks.4.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.4.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.4.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.4.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.attn.proj.bias appended to params list
Parameter name blocks.4.attn.proj.bias appended to names list
Parameter blocks.4.attn.proj.bias added successfully
Processing parameter: blocks.4.norm2.weight
TPU mode: blocks.4.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.4.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.4.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.4.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.norm2.weight appended to params list
Parameter name blocks.4.norm2.weight appended to names list
Parameter blocks.4.norm2.weight added successfully
Processing parameter 60: blocks.4.norm2.bias
Processing parameter: blocks.4.norm2.bias
TPU mode: blocks.4.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.4.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.4.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.4.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.norm2.bias appended to params list
Parameter name blocks.4.norm2.bias appended to names list
Parameter blocks.4.norm2.bias added successfully
Processing parameter: blocks.4.mlp.fc1.weight
TPU mode: blocks.4.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.4.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.4.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.4.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.mlp.fc1.weight appended to params list
Parameter name blocks.4.mlp.fc1.weight appended to names list
Parameter blocks.4.mlp.fc1.weight added successfully
Processing parameter: blocks.4.mlp.fc1.bias
TPU mode: blocks.4.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.4.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.4.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.4.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.mlp.fc1.bias appended to params list
Parameter name blocks.4.mlp.fc1.bias appended to names list
Parameter blocks.4.mlp.fc1.bias added successfully
Processing parameter: blocks.4.mlp.fc2.weight
TPU mode: blocks.4.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.4.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.4.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.4.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.mlp.fc2.weight appended to params list
Parameter name blocks.4.mlp.fc2.weight appended to names list
Parameter blocks.4.mlp.fc2.weight added successfully
Processing parameter: blocks.4.mlp.fc2.bias
TPU mode: blocks.4.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.4.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.4.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.4.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.4.mlp.fc2.bias appended to params list
Parameter name blocks.4.mlp.fc2.bias appended to names list
Parameter blocks.4.mlp.fc2.bias added successfully
Processing parameter: blocks.5.norm1.weight
TPU mode: blocks.5.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.5.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.5.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.5.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.norm1.weight appended to params list
Parameter name blocks.5.norm1.weight appended to names list
Parameter blocks.5.norm1.weight added successfully
Processing parameter: blocks.5.norm1.bias
TPU mode: blocks.5.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.5.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.5.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.5.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.norm1.bias appended to params list
Parameter name blocks.5.norm1.bias appended to names list
Parameter blocks.5.norm1.bias added successfully
Processing parameter: blocks.5.attn.qkv.weight
TPU mode: blocks.5.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.5.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.5.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.5.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.attn.qkv.weight appended to params list
Parameter name blocks.5.attn.qkv.weight appended to names list
Parameter blocks.5.attn.qkv.weight added successfully
Processing parameter: blocks.5.attn.qkv.bias
TPU mode: blocks.5.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.5.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.5.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.5.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.attn.qkv.bias appended to params list
Parameter name blocks.5.attn.qkv.bias appended to names list
Parameter blocks.5.attn.qkv.bias added successfully
Processing parameter: blocks.5.attn.proj.weight
TPU mode: blocks.5.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.5.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.5.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.5.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.attn.proj.weight appended to params list
Parameter name blocks.5.attn.proj.weight appended to names list
Parameter blocks.5.attn.proj.weight added successfully
Processing parameter 70: blocks.5.attn.proj.bias
Processing parameter: blocks.5.attn.proj.bias
TPU mode: blocks.5.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.5.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.5.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.5.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.attn.proj.bias appended to params list
Parameter name blocks.5.attn.proj.bias appended to names list
Parameter blocks.5.attn.proj.bias added successfully
Processing parameter: blocks.5.norm2.weight
TPU mode: blocks.5.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.5.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.5.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.5.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.norm2.weight appended to params list
Parameter name blocks.5.norm2.weight appended to names list
Parameter blocks.5.norm2.weight added successfully
Processing parameter: blocks.5.norm2.bias
TPU mode: blocks.5.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.5.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.5.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.5.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.norm2.bias appended to params list
Parameter name blocks.5.norm2.bias appended to names list
Parameter blocks.5.norm2.bias added successfully
Processing parameter: blocks.5.mlp.fc1.weight
TPU mode: blocks.5.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.5.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.5.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.5.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.mlp.fc1.weight appended to params list
Parameter name blocks.5.mlp.fc1.weight appended to names list
Parameter blocks.5.mlp.fc1.weight added successfully
Processing parameter: blocks.5.mlp.fc1.bias
TPU mode: blocks.5.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.5.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.5.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.5.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.mlp.fc1.bias appended to params list
Parameter name blocks.5.mlp.fc1.bias appended to names list
Parameter blocks.5.mlp.fc1.bias added successfully
Processing parameter: blocks.5.mlp.fc2.weight
TPU mode: blocks.5.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.5.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.5.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.5.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.mlp.fc2.weight appended to params list
Parameter name blocks.5.mlp.fc2.weight appended to names list
Parameter blocks.5.mlp.fc2.weight added successfully
Processing parameter: blocks.5.mlp.fc2.bias
TPU mode: blocks.5.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.5.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.5.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.5.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.5.mlp.fc2.bias appended to params list
Parameter name blocks.5.mlp.fc2.bias appended to names list
Parameter blocks.5.mlp.fc2.bias added successfully
Processing parameter: blocks.6.norm1.weight
TPU mode: blocks.6.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.6.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.6.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.6.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.norm1.weight appended to params list
Parameter name blocks.6.norm1.weight appended to names list
Parameter blocks.6.norm1.weight added successfully
Processing parameter: blocks.6.norm1.bias
TPU mode: blocks.6.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.6.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.6.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.6.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.norm1.bias appended to params list
Parameter name blocks.6.norm1.bias appended to names list
Parameter blocks.6.norm1.bias added successfully
Processing parameter: blocks.6.attn.qkv.weight
TPU mode: blocks.6.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.6.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.6.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.6.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.attn.qkv.weight appended to params list
Parameter name blocks.6.attn.qkv.weight appended to names list
Parameter blocks.6.attn.qkv.weight added successfully
Processing parameter 80: blocks.6.attn.qkv.bias
Processing parameter: blocks.6.attn.qkv.bias
TPU mode: blocks.6.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.6.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.6.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.6.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.attn.qkv.bias appended to params list
Parameter name blocks.6.attn.qkv.bias appended to names list
Parameter blocks.6.attn.qkv.bias added successfully
Processing parameter: blocks.6.attn.proj.weight
TPU mode: blocks.6.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.6.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.6.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.6.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.attn.proj.weight appended to params list
Parameter name blocks.6.attn.proj.weight appended to names list
Parameter blocks.6.attn.proj.weight added successfully
Processing parameter: blocks.6.attn.proj.bias
TPU mode: blocks.6.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.6.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.6.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.6.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.attn.proj.bias appended to params list
Parameter name blocks.6.attn.proj.bias appended to names list
Parameter blocks.6.attn.proj.bias added successfully
Processing parameter: blocks.6.norm2.weight
TPU mode: blocks.6.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.6.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.6.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.6.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.norm2.weight appended to params list
Parameter name blocks.6.norm2.weight appended to names list
Parameter blocks.6.norm2.weight added successfully
Processing parameter: blocks.6.norm2.bias
TPU mode: blocks.6.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.6.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.6.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.6.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.norm2.bias appended to params list
Parameter name blocks.6.norm2.bias appended to names list
Parameter blocks.6.norm2.bias added successfully
Processing parameter: blocks.6.mlp.fc1.weight
TPU mode: blocks.6.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.6.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.6.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.6.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.mlp.fc1.weight appended to params list
Parameter name blocks.6.mlp.fc1.weight appended to names list
Parameter blocks.6.mlp.fc1.weight added successfully
Processing parameter: blocks.6.mlp.fc1.bias
TPU mode: blocks.6.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.6.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.6.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.6.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.mlp.fc1.bias appended to params list
Parameter name blocks.6.mlp.fc1.bias appended to names list
Parameter blocks.6.mlp.fc1.bias added successfully
Processing parameter: blocks.6.mlp.fc2.weight
TPU mode: blocks.6.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.6.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.6.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.6.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.mlp.fc2.weight appended to params list
Parameter name blocks.6.mlp.fc2.weight appended to names list
Parameter blocks.6.mlp.fc2.weight added successfully
Processing parameter: blocks.6.mlp.fc2.bias
TPU mode: blocks.6.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.6.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.6.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.6.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.6.mlp.fc2.bias appended to params list
Parameter name blocks.6.mlp.fc2.bias appended to names list
Parameter blocks.6.mlp.fc2.bias added successfully
Processing parameter: blocks.7.norm1.weight
TPU mode: blocks.7.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.7.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.7.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.7.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.norm1.weight appended to params list
Parameter name blocks.7.norm1.weight appended to names list
Parameter blocks.7.norm1.weight added successfully
Processing parameter 90: blocks.7.norm1.bias
Processing parameter: blocks.7.norm1.bias
TPU mode: blocks.7.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.7.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.7.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.7.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.norm1.bias appended to params list
Parameter name blocks.7.norm1.bias appended to names list
Parameter blocks.7.norm1.bias added successfully
Processing parameter: blocks.7.attn.qkv.weight
TPU mode: blocks.7.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.7.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.7.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.7.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.attn.qkv.weight appended to params list
Parameter name blocks.7.attn.qkv.weight appended to names list
Parameter blocks.7.attn.qkv.weight added successfully
Processing parameter: blocks.7.attn.qkv.bias
TPU mode: blocks.7.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.7.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.7.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.7.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.attn.qkv.bias appended to params list
Parameter name blocks.7.attn.qkv.bias appended to names list
Parameter blocks.7.attn.qkv.bias added successfully
Processing parameter: blocks.7.attn.proj.weight
TPU mode: blocks.7.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.7.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.7.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.7.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.attn.proj.weight appended to params list
Parameter name blocks.7.attn.proj.weight appended to names list
Parameter blocks.7.attn.proj.weight added successfully
Processing parameter: blocks.7.attn.proj.bias
TPU mode: blocks.7.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.7.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.7.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.7.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.attn.proj.bias appended to params list
Parameter name blocks.7.attn.proj.bias appended to names list
Parameter blocks.7.attn.proj.bias added successfully
Processing parameter: blocks.7.norm2.weight
TPU mode: blocks.7.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.7.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.7.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.7.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.norm2.weight appended to params list
Parameter name blocks.7.norm2.weight appended to names list
Parameter blocks.7.norm2.weight added successfully
Processing parameter: blocks.7.norm2.bias
TPU mode: blocks.7.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.7.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.7.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.7.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.norm2.bias appended to params list
Parameter name blocks.7.norm2.bias appended to names list
Parameter blocks.7.norm2.bias added successfully
Processing parameter: blocks.7.mlp.fc1.weight
TPU mode: blocks.7.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.7.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.7.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.7.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.mlp.fc1.weight appended to params list
Parameter name blocks.7.mlp.fc1.weight appended to names list
Parameter blocks.7.mlp.fc1.weight added successfully
Processing parameter: blocks.7.mlp.fc1.bias
TPU mode: blocks.7.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.7.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.7.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.7.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.mlp.fc1.bias appended to params list
Parameter name blocks.7.mlp.fc1.bias appended to names list
Parameter blocks.7.mlp.fc1.bias added successfully
Processing parameter: blocks.7.mlp.fc2.weight
TPU mode: blocks.7.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.7.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.7.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.7.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.mlp.fc2.weight appended to params list
Parameter name blocks.7.mlp.fc2.weight appended to names list
Parameter blocks.7.mlp.fc2.weight added successfully
Processing parameter 100: blocks.7.mlp.fc2.bias
Processing parameter: blocks.7.mlp.fc2.bias
TPU mode: blocks.7.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.7.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.7.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.7.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.7.mlp.fc2.bias appended to params list
Parameter name blocks.7.mlp.fc2.bias appended to names list
Parameter blocks.7.mlp.fc2.bias added successfully
Processing parameter: blocks.8.norm1.weight
TPU mode: blocks.8.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.8.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.8.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.8.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.norm1.weight appended to params list
Parameter name blocks.8.norm1.weight appended to names list
Parameter blocks.8.norm1.weight added successfully
Processing parameter: blocks.8.norm1.bias
TPU mode: blocks.8.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.8.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.8.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.8.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.norm1.bias appended to params list
Parameter name blocks.8.norm1.bias appended to names list
Parameter blocks.8.norm1.bias added successfully
Processing parameter: blocks.8.attn.qkv.weight
TPU mode: blocks.8.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.8.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.8.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.8.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.attn.qkv.weight appended to params list
Parameter name blocks.8.attn.qkv.weight appended to names list
Parameter blocks.8.attn.qkv.weight added successfully
Processing parameter: blocks.8.attn.qkv.bias
TPU mode: blocks.8.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.8.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.8.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.8.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.attn.qkv.bias appended to params list
Parameter name blocks.8.attn.qkv.bias appended to names list
Parameter blocks.8.attn.qkv.bias added successfully
Processing parameter: blocks.8.attn.proj.weight
TPU mode: blocks.8.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.8.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.8.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.8.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.attn.proj.weight appended to params list
Parameter name blocks.8.attn.proj.weight appended to names list
Parameter blocks.8.attn.proj.weight added successfully
Processing parameter: blocks.8.attn.proj.bias
TPU mode: blocks.8.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.8.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.8.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.8.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.attn.proj.bias appended to params list
Parameter name blocks.8.attn.proj.bias appended to names list
Parameter blocks.8.attn.proj.bias added successfully
Processing parameter: blocks.8.norm2.weight
TPU mode: blocks.8.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.8.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.8.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.8.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.norm2.weight appended to params list
Parameter name blocks.8.norm2.weight appended to names list
Parameter blocks.8.norm2.weight added successfully
Processing parameter: blocks.8.norm2.bias
TPU mode: blocks.8.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.8.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.8.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.8.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.norm2.bias appended to params list
Parameter name blocks.8.norm2.bias appended to names list
Parameter blocks.8.norm2.bias added successfully
Processing parameter: blocks.8.mlp.fc1.weight
TPU mode: blocks.8.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.8.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.8.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.8.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.mlp.fc1.weight appended to params list
Parameter name blocks.8.mlp.fc1.weight appended to names list
Parameter blocks.8.mlp.fc1.weight added successfully
Processing parameter 110: blocks.8.mlp.fc1.bias
Processing parameter: blocks.8.mlp.fc1.bias
TPU mode: blocks.8.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.8.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.8.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.8.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.mlp.fc1.bias appended to params list
Parameter name blocks.8.mlp.fc1.bias appended to names list
Parameter blocks.8.mlp.fc1.bias added successfully
Processing parameter: blocks.8.mlp.fc2.weight
TPU mode: blocks.8.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.8.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.8.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.8.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.mlp.fc2.weight appended to params list
Parameter name blocks.8.mlp.fc2.weight appended to names list
Parameter blocks.8.mlp.fc2.weight added successfully
Processing parameter: blocks.8.mlp.fc2.bias
TPU mode: blocks.8.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.8.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.8.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.8.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.8.mlp.fc2.bias appended to params list
Parameter name blocks.8.mlp.fc2.bias appended to names list
Parameter blocks.8.mlp.fc2.bias added successfully
Processing parameter: blocks.9.norm1.weight
TPU mode: blocks.9.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.9.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.9.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.9.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.norm1.weight appended to params list
Parameter name blocks.9.norm1.weight appended to names list
Parameter blocks.9.norm1.weight added successfully
Processing parameter: blocks.9.norm1.bias
TPU mode: blocks.9.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.9.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.9.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.9.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.norm1.bias appended to params list
Parameter name blocks.9.norm1.bias appended to names list
Parameter blocks.9.norm1.bias added successfully
Processing parameter: blocks.9.attn.qkv.weight
TPU mode: blocks.9.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.9.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.9.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.9.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.attn.qkv.weight appended to params list
Parameter name blocks.9.attn.qkv.weight appended to names list
Parameter blocks.9.attn.qkv.weight added successfully
Processing parameter: blocks.9.attn.qkv.bias
TPU mode: blocks.9.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.9.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.9.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.9.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.attn.qkv.bias appended to params list
Parameter name blocks.9.attn.qkv.bias appended to names list
Parameter blocks.9.attn.qkv.bias added successfully
Processing parameter: blocks.9.attn.proj.weight
TPU mode: blocks.9.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.9.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.9.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.9.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.attn.proj.weight appended to params list
Parameter name blocks.9.attn.proj.weight appended to names list
Parameter blocks.9.attn.proj.weight added successfully
Processing parameter: blocks.9.attn.proj.bias
TPU mode: blocks.9.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.9.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.9.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.9.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.attn.proj.bias appended to params list
Parameter name blocks.9.attn.proj.bias appended to names list
Parameter blocks.9.attn.proj.bias added successfully
Processing parameter: blocks.9.norm2.weight
TPU mode: blocks.9.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.9.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.9.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.9.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.norm2.weight appended to params list
Parameter name blocks.9.norm2.weight appended to names list
Parameter blocks.9.norm2.weight added successfully
Processing parameter 120: blocks.9.norm2.bias
Processing parameter: blocks.9.norm2.bias
TPU mode: blocks.9.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.9.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.9.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.9.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.norm2.bias appended to params list
Parameter name blocks.9.norm2.bias appended to names list
Parameter blocks.9.norm2.bias added successfully
Processing parameter: blocks.9.mlp.fc1.weight
TPU mode: blocks.9.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.9.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.9.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.9.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.mlp.fc1.weight appended to params list
Parameter name blocks.9.mlp.fc1.weight appended to names list
Parameter blocks.9.mlp.fc1.weight added successfully
Processing parameter: blocks.9.mlp.fc1.bias
TPU mode: blocks.9.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.9.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.9.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.9.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.mlp.fc1.bias appended to params list
Parameter name blocks.9.mlp.fc1.bias appended to names list
Parameter blocks.9.mlp.fc1.bias added successfully
Processing parameter: blocks.9.mlp.fc2.weight
TPU mode: blocks.9.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.9.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.9.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.9.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.mlp.fc2.weight appended to params list
Parameter name blocks.9.mlp.fc2.weight appended to names list
Parameter blocks.9.mlp.fc2.weight added successfully
Processing parameter: blocks.9.mlp.fc2.bias
TPU mode: blocks.9.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.9.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.9.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.9.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.9.mlp.fc2.bias appended to params list
Parameter name blocks.9.mlp.fc2.bias appended to names list
Parameter blocks.9.mlp.fc2.bias added successfully
Processing parameter: blocks.10.norm1.weight
TPU mode: blocks.10.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.10.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.10.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.10.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.norm1.weight appended to params list
Parameter name blocks.10.norm1.weight appended to names list
Parameter blocks.10.norm1.weight added successfully
Processing parameter: blocks.10.norm1.bias
TPU mode: blocks.10.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.10.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.10.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.10.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.norm1.bias appended to params list
Parameter name blocks.10.norm1.bias appended to names list
Parameter blocks.10.norm1.bias added successfully
Processing parameter: blocks.10.attn.qkv.weight
TPU mode: blocks.10.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.10.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.10.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.10.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.attn.qkv.weight appended to params list
Parameter name blocks.10.attn.qkv.weight appended to names list
Parameter blocks.10.attn.qkv.weight added successfully
Processing parameter: blocks.10.attn.qkv.bias
TPU mode: blocks.10.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.10.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.10.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.10.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.attn.qkv.bias appended to params list
Parameter name blocks.10.attn.qkv.bias appended to names list
Parameter blocks.10.attn.qkv.bias added successfully
Processing parameter: blocks.10.attn.proj.weight
TPU mode: blocks.10.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.10.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.10.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.10.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.attn.proj.weight appended to params list
Parameter name blocks.10.attn.proj.weight appended to names list
Parameter blocks.10.attn.proj.weight added successfully
Processing parameter 130: blocks.10.attn.proj.bias
Processing parameter: blocks.10.attn.proj.bias
TPU mode: blocks.10.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.10.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.10.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.10.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.attn.proj.bias appended to params list
Parameter name blocks.10.attn.proj.bias appended to names list
Parameter blocks.10.attn.proj.bias added successfully
Processing parameter: blocks.10.norm2.weight
TPU mode: blocks.10.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.10.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.10.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.10.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.norm2.weight appended to params list
Parameter name blocks.10.norm2.weight appended to names list
Parameter blocks.10.norm2.weight added successfully
Processing parameter: blocks.10.norm2.bias
TPU mode: blocks.10.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.10.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.10.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.10.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.norm2.bias appended to params list
Parameter name blocks.10.norm2.bias appended to names list
Parameter blocks.10.norm2.bias added successfully
Processing parameter: blocks.10.mlp.fc1.weight
TPU mode: blocks.10.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.10.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.10.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.10.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.mlp.fc1.weight appended to params list
Parameter name blocks.10.mlp.fc1.weight appended to names list
Parameter blocks.10.mlp.fc1.weight added successfully
Processing parameter: blocks.10.mlp.fc1.bias
TPU mode: blocks.10.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.10.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.10.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.10.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.mlp.fc1.bias appended to params list
Parameter name blocks.10.mlp.fc1.bias appended to names list
Parameter blocks.10.mlp.fc1.bias added successfully
Processing parameter: blocks.10.mlp.fc2.weight
TPU mode: blocks.10.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.10.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.10.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.10.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.mlp.fc2.weight appended to params list
Parameter name blocks.10.mlp.fc2.weight appended to names list
Parameter blocks.10.mlp.fc2.weight added successfully
Processing parameter: blocks.10.mlp.fc2.bias
TPU mode: blocks.10.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.10.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.10.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.10.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.10.mlp.fc2.bias appended to params list
Parameter name blocks.10.mlp.fc2.bias appended to names list
Parameter blocks.10.mlp.fc2.bias added successfully
Processing parameter: blocks.11.norm1.weight
TPU mode: blocks.11.norm1.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.11.norm1.weight to group no_decay
TPU mode: About to append parameter blocks.11.norm1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.11.norm1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.norm1.weight appended to params list
Parameter name blocks.11.norm1.weight appended to names list
Parameter blocks.11.norm1.weight added successfully
Processing parameter: blocks.11.norm1.bias
TPU mode: blocks.11.norm1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.11.norm1.bias to group no_decay
TPU mode: About to append parameter blocks.11.norm1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.11.norm1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.norm1.bias appended to params list
Parameter name blocks.11.norm1.bias appended to names list
Parameter blocks.11.norm1.bias added successfully
Processing parameter: blocks.11.attn.qkv.weight
TPU mode: blocks.11.attn.qkv.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.11.attn.qkv.weight to group decay
TPU mode: About to append parameter blocks.11.attn.qkv.weight to group...
TPU mode: Carefully appending XLA tensor blocks.11.attn.qkv.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.attn.qkv.weight appended to params list
Parameter name blocks.11.attn.qkv.weight appended to names list
Parameter blocks.11.attn.qkv.weight added successfully
Processing parameter 140: blocks.11.attn.qkv.bias
Processing parameter: blocks.11.attn.qkv.bias
TPU mode: blocks.11.attn.qkv.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.11.attn.qkv.bias to group no_decay
TPU mode: About to append parameter blocks.11.attn.qkv.bias to group...
TPU mode: Carefully appending XLA tensor blocks.11.attn.qkv.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.attn.qkv.bias appended to params list
Parameter name blocks.11.attn.qkv.bias appended to names list
Parameter blocks.11.attn.qkv.bias added successfully
Processing parameter: blocks.11.attn.proj.weight
TPU mode: blocks.11.attn.proj.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.11.attn.proj.weight to group decay
TPU mode: About to append parameter blocks.11.attn.proj.weight to group...
TPU mode: Carefully appending XLA tensor blocks.11.attn.proj.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.attn.proj.weight appended to params list
Parameter name blocks.11.attn.proj.weight appended to names list
Parameter blocks.11.attn.proj.weight added successfully
Processing parameter: blocks.11.attn.proj.bias
TPU mode: blocks.11.attn.proj.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.11.attn.proj.bias to group no_decay
TPU mode: About to append parameter blocks.11.attn.proj.bias to group...
TPU mode: Carefully appending XLA tensor blocks.11.attn.proj.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.attn.proj.bias appended to params list
Parameter name blocks.11.attn.proj.bias appended to names list
Parameter blocks.11.attn.proj.bias added successfully
Processing parameter: blocks.11.norm2.weight
TPU mode: blocks.11.norm2.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.11.norm2.weight to group no_decay
TPU mode: About to append parameter blocks.11.norm2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.11.norm2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.norm2.weight appended to params list
Parameter name blocks.11.norm2.weight appended to names list
Parameter blocks.11.norm2.weight added successfully
Processing parameter: blocks.11.norm2.bias
TPU mode: blocks.11.norm2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.11.norm2.bias to group no_decay
TPU mode: About to append parameter blocks.11.norm2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.11.norm2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.norm2.bias appended to params list
Parameter name blocks.11.norm2.bias appended to names list
Parameter blocks.11.norm2.bias added successfully
Processing parameter: blocks.11.mlp.fc1.weight
TPU mode: blocks.11.mlp.fc1.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.11.mlp.fc1.weight to group decay
TPU mode: About to append parameter blocks.11.mlp.fc1.weight to group...
TPU mode: Carefully appending XLA tensor blocks.11.mlp.fc1.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.mlp.fc1.weight appended to params list
Parameter name blocks.11.mlp.fc1.weight appended to names list
Parameter blocks.11.mlp.fc1.weight added successfully
Processing parameter: blocks.11.mlp.fc1.bias
TPU mode: blocks.11.mlp.fc1.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.11.mlp.fc1.bias to group no_decay
TPU mode: About to append parameter blocks.11.mlp.fc1.bias to group...
TPU mode: Carefully appending XLA tensor blocks.11.mlp.fc1.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.mlp.fc1.bias appended to params list
Parameter name blocks.11.mlp.fc1.bias appended to names list
Parameter blocks.11.mlp.fc1.bias added successfully
Processing parameter: blocks.11.mlp.fc2.weight
TPU mode: blocks.11.mlp.fc2.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter blocks.11.mlp.fc2.weight to group decay
TPU mode: About to append parameter blocks.11.mlp.fc2.weight to group...
TPU mode: Carefully appending XLA tensor blocks.11.mlp.fc2.weight...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.mlp.fc2.weight appended to params list
Parameter name blocks.11.mlp.fc2.weight appended to names list
Parameter blocks.11.mlp.fc2.weight added successfully
Processing parameter: blocks.11.mlp.fc2.bias
TPU mode: blocks.11.mlp.fc2.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter blocks.11.mlp.fc2.bias to group no_decay
TPU mode: About to append parameter blocks.11.mlp.fc2.bias to group...
TPU mode: Carefully appending XLA tensor blocks.11.mlp.fc2.bias...
TPU mode: XLA mark_step() before append completed
Parameter blocks.11.mlp.fc2.bias appended to params list
Parameter name blocks.11.mlp.fc2.bias appended to names list
Parameter blocks.11.mlp.fc2.bias added successfully
Processing parameter: fc_norm.weight
TPU mode: fc_norm.weight -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter fc_norm.weight to group no_decay
TPU mode: About to append parameter fc_norm.weight to group...
TPU mode: Carefully appending XLA tensor fc_norm.weight...
TPU mode: XLA mark_step() before append completed
Parameter fc_norm.weight appended to params list
Parameter name fc_norm.weight appended to names list
Parameter fc_norm.weight added successfully
Processing parameter 150: fc_norm.bias
Processing parameter: fc_norm.bias
TPU mode: fc_norm.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter fc_norm.bias to group no_decay
TPU mode: About to append parameter fc_norm.bias to group...
TPU mode: Carefully appending XLA tensor fc_norm.bias...
TPU mode: XLA mark_step() before append completed
Parameter fc_norm.bias appended to params list
Parameter name fc_norm.bias appended to names list
Parameter fc_norm.bias added successfully
Processing parameter: head.weight
TPU mode: head.weight -> is_bias_or_1d = False
Group name: decay, weight_decay: 0.05
Adding parameter head.weight to group decay
TPU mode: About to append parameter head.weight to group...
TPU mode: Carefully appending XLA tensor head.weight...
TPU mode: XLA mark_step() before append completed
Parameter head.weight appended to params list
Parameter name head.weight appended to names list
Parameter head.weight added successfully
Processing parameter: head.bias
TPU mode: head.bias -> is_bias_or_1d = True
Group name: no_decay, weight_decay: 0.0
Adding parameter head.bias to group no_decay
TPU mode: About to append parameter head.bias to group...
TPU mode: Carefully appending XLA tensor head.bias...
TPU mode: XLA mark_step() before append completed
Parameter head.bias appended to params list
Parameter name head.bias appended to names list
Parameter head.bias added successfully
Parameter iteration completed, about to print param groups...
TPU mode: Skipping detailed param group printing to avoid XLA issues
Created 2 parameter groups
  - no_decay: 102 parameters
  - decay: 50 parameters
About to return parameter groups...
Parameter groups created successfully
Optimizer created successfully
Using device type: xla
About to create loss scaler...
Loss scaler created successfully
About to create Cosine LR scheduler...
Set warmup steps = 12500
LR scheduler created successfully
Set warmup steps = 0
Max WD = 0.0500000, Min WD = 0.0500000
criterion = SoftTargetCrossEntropy()
Start training for 100 epochs
Epoch: [0]  [  0/625]  eta: 10:59:27  loss: 7.0938 (7.0938)  lr: 0.0000 (0.0000)  time: 63.3081  data: 0.5508
